                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.9.0 #11195 (MINGW64)
                              4 ;--------------------------------------------------------
                              5 	.module WYZplayer
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _TABLA_DATOS_CANAL_SFX
                             12 	.globl _SELECT_CANAL_C
                             13 	.globl _SELECT_CANAL_B
                             14 	.globl _SELECT_CANAL_A
                             15 	.globl _DATOS_NOTAS
                             16 	.globl _TABLA_SONIDOS
                             17 	.globl _TABLA_PAUTAS
                             18 	.globl _TABLA_SONG
                             19 	.globl _SOUND_BUFFER_P
                             20 	.globl _SOUND_BUFFER_C
                             21 	.globl _SOUND_BUFFER_B
                             22 	.globl _SOUND_BUFFER_A
                             23 	.globl _ENVOLVENTE_BACK
                             24 	.globl _ENVOLVENTE
                             25 	.globl _AYREGS
                             26 	.globl _PSG_REG
                             27 	.globl _PUNTERO_SONIDO
                             28 	.globl _N_SONIDO
                             29 	.globl _SFX_MIX
                             30 	.globl _SFX_V
                             31 	.globl _SFX_H
                             32 	.globl _SFX_L
                             33 	.globl _PUNTERO_L_DECP
                             34 	.globl _PUNTERO_DECP
                             35 	.globl _PUNTERO_P_DECP
                             36 	.globl _CANAL_P
                             37 	.globl _PUNTERO_P
                             38 	.globl _PUNTERO_L_DECC
                             39 	.globl _PUNTERO_L_DECB
                             40 	.globl _PUNTERO_L_DECA
                             41 	.globl _VOL_INST_C
                             42 	.globl _REG_NOTA_C
                             43 	.globl _VOL_INST_B
                             44 	.globl _REG_NOTA_B
                             45 	.globl _VOL_INST_A
                             46 	.globl _REG_NOTA_A
                             47 	.globl _PUNTERO_DECC
                             48 	.globl _PUNTERO_DECB
                             49 	.globl _PUNTERO_DECA
                             50 	.globl _PUNTERO_P_DECC
                             51 	.globl _PUNTERO_P_DECB
                             52 	.globl _PUNTERO_P_DECA
                             53 	.globl _PUNTERO_P_C0
                             54 	.globl _PUNTERO_P_B0
                             55 	.globl _PUNTERO_P_A0
                             56 	.globl _PUNTERO_P_C
                             57 	.globl _PUNTERO_P_B
                             58 	.globl _PUNTERO_P_A
                             59 	.globl _CANAL_C
                             60 	.globl _CANAL_B
                             61 	.globl _CANAL_A
                             62 	.globl _PUNTERO_C
                             63 	.globl _PUNTERO_B
                             64 	.globl _PUNTERO_A
                             65 	.globl _TTEMPO
                             66 	.globl _TEMPO
                             67 	.globl _SONG
                             68 	.globl _WYZstate
                             69 	.globl _Player_Init
                             70 	.globl _Player_Pause
                             71 	.globl _Player_Resume
                             72 	.globl _Player_Loop
                             73 	.globl _PlayFX
                             74 	.globl _PlayAY
                             75 	.globl _Player_InitSong
                             76 	.globl _Player_Decode
                             77 ;--------------------------------------------------------
                             78 ; special function registers
                             79 ;--------------------------------------------------------
                             80 ;--------------------------------------------------------
                             81 ; ram data
                             82 ;--------------------------------------------------------
                             83 	.area _DATA
   0000                      84 _WYZstate::
   0000                      85 	.ds 1
   0001                      86 _SONG::
   0001                      87 	.ds 1
   0002                      88 _TEMPO::
   0002                      89 	.ds 1
   0003                      90 _TTEMPO::
   0003                      91 	.ds 1
   0004                      92 _PUNTERO_A::
   0004                      93 	.ds 2
   0006                      94 _PUNTERO_B::
   0006                      95 	.ds 2
   0008                      96 _PUNTERO_C::
   0008                      97 	.ds 2
   000A                      98 _CANAL_A::
   000A                      99 	.ds 2
   000C                     100 _CANAL_B::
   000C                     101 	.ds 2
   000E                     102 _CANAL_C::
   000E                     103 	.ds 2
   0010                     104 _PUNTERO_P_A::
   0010                     105 	.ds 2
   0012                     106 _PUNTERO_P_B::
   0012                     107 	.ds 2
   0014                     108 _PUNTERO_P_C::
   0014                     109 	.ds 2
   0016                     110 _PUNTERO_P_A0::
   0016                     111 	.ds 2
   0018                     112 _PUNTERO_P_B0::
   0018                     113 	.ds 2
   001A                     114 _PUNTERO_P_C0::
   001A                     115 	.ds 2
   001C                     116 _PUNTERO_P_DECA::
   001C                     117 	.ds 2
   001E                     118 _PUNTERO_P_DECB::
   001E                     119 	.ds 2
   0020                     120 _PUNTERO_P_DECC::
   0020                     121 	.ds 2
   0022                     122 _PUNTERO_DECA::
   0022                     123 	.ds 2
   0024                     124 _PUNTERO_DECB::
   0024                     125 	.ds 2
   0026                     126 _PUNTERO_DECC::
   0026                     127 	.ds 2
   0028                     128 _REG_NOTA_A::
   0028                     129 	.ds 1
   0029                     130 _VOL_INST_A::
   0029                     131 	.ds 1
   002A                     132 _REG_NOTA_B::
   002A                     133 	.ds 1
   002B                     134 _VOL_INST_B::
   002B                     135 	.ds 1
   002C                     136 _REG_NOTA_C::
   002C                     137 	.ds 1
   002D                     138 _VOL_INST_C::
   002D                     139 	.ds 1
   002E                     140 _PUNTERO_L_DECA::
   002E                     141 	.ds 2
   0030                     142 _PUNTERO_L_DECB::
   0030                     143 	.ds 2
   0032                     144 _PUNTERO_L_DECC::
   0032                     145 	.ds 2
   0034                     146 _PUNTERO_P::
   0034                     147 	.ds 2
   0036                     148 _CANAL_P::
   0036                     149 	.ds 2
   0038                     150 _PUNTERO_P_DECP::
   0038                     151 	.ds 2
   003A                     152 _PUNTERO_DECP::
   003A                     153 	.ds 2
   003C                     154 _PUNTERO_L_DECP::
   003C                     155 	.ds 2
   003E                     156 _SFX_L::
   003E                     157 	.ds 2
   0040                     158 _SFX_H::
   0040                     159 	.ds 2
   0042                     160 _SFX_V::
   0042                     161 	.ds 2
   0044                     162 _SFX_MIX::
   0044                     163 	.ds 2
   0046                     164 _N_SONIDO::
   0046                     165 	.ds 1
   0047                     166 _PUNTERO_SONIDO::
   0047                     167 	.ds 2
   0049                     168 _PSG_REG::
   0049                     169 	.ds 16
   0059                     170 _AYREGS::
   0059                     171 	.ds 16
   0069                     172 _ENVOLVENTE::
   0069                     173 	.ds 1
   006A                     174 _ENVOLVENTE_BACK::
   006A                     175 	.ds 1
   006B                     176 _SOUND_BUFFER_A::
   006B                     177 	.ds 16
   007B                     178 _SOUND_BUFFER_B::
   007B                     179 	.ds 16
   008B                     180 _SOUND_BUFFER_C::
   008B                     181 	.ds 16
   009B                     182 _SOUND_BUFFER_P::
   009B                     183 	.ds 16
   00AB                     184 _TABLA_SONG::
   00AB                     185 	.ds 2
   00AD                     186 _TABLA_PAUTAS::
   00AD                     187 	.ds 2
   00AF                     188 _TABLA_SONIDOS::
   00AF                     189 	.ds 2
   00B1                     190 _DATOS_NOTAS::
   00B1                     191 	.ds 2
   00B3                     192 _SELECT_CANAL_A::
   00B3                     193 	.ds 7
   00BA                     194 _SELECT_CANAL_B::
   00BA                     195 	.ds 7
   00C1                     196 _SELECT_CANAL_C::
   00C1                     197 	.ds 7
   00C8                     198 _TABLA_DATOS_CANAL_SFX::
   00C8                     199 	.ds 6
                            200 ;--------------------------------------------------------
                            201 ; ram data
                            202 ;--------------------------------------------------------
                            203 	.area _INITIALIZED
                            204 ;--------------------------------------------------------
                            205 ; absolute external ram data
                            206 ;--------------------------------------------------------
                            207 	.area _DABS (ABS)
                            208 ;--------------------------------------------------------
                            209 ; global & static initialisations
                            210 ;--------------------------------------------------------
                            211 	.area _HOME
                            212 	.area _GSINIT
                            213 	.area _GSFINAL
                            214 	.area _GSINIT
                            215 ;--------------------------------------------------------
                            216 ; Home
                            217 ;--------------------------------------------------------
                            218 	.area _HOME
                            219 	.area _HOME
                            220 ;--------------------------------------------------------
                            221 ; code
                            222 ;--------------------------------------------------------
                            223 	.area _CODE
                            224 ;src\WYZplayer.c:193: void Player_Init(unsigned int addrSONGs, unsigned int addrInstruments, unsigned int addrFXs, unsigned int addrFreqs) __naked
                            225 ;	---------------------------------
                            226 ; Function Player_Init
                            227 ; ---------------------------------
   0000                     228 _Player_Init::
                            229 ;src\WYZplayer.c:292: __endasm;
   0000 DD E5         [15]  230 	push	IX
   0002 DD 21 00 00   [14]  231 	ld	IX,#0
   0006 DD 39         [15]  232 	add	IX,SP
   0008 DD 6E 04      [19]  233 	ld	L,4(IX)
   000B DD 66 05      [19]  234 	ld	H,5(IX)
   000E 22rABr00      [16]  235 	ld	(#_TABLA_SONG),HL
   0011 DD 6E 06      [19]  236 	ld	L,6(IX)
   0014 DD 66 07      [19]  237 	ld	H,7(IX)
   0017 22rADr00      [16]  238 	ld	(#_TABLA_PAUTAS),HL
   001A DD 6E 08      [19]  239 	ld	L,8(IX)
   001D DD 66 09      [19]  240 	ld	H,9(IX)
   0020 22rAFr00      [16]  241 	ld	(#_TABLA_SONIDOS),HL
   0023 DD 6E 0A      [19]  242 	ld	L,10(IX)
   0026 DD 66 0B      [19]  243 	ld	H,11(IX)
   0029 22rB1r00      [16]  244 	ld	(#_DATOS_NOTAS),HL
   002C AF            [ 4]  245 	XOR	A
   002D 32r00r00      [13]  246 	LD	(#_WYZstate),A
   0030 CDrAAr00      [17]  247 	call	CLEAR_PSG_BUFFER ;PLAYER_OFF
   0033 21r6Br00      [10]  248 	LD	HL,#_SOUND_BUFFER_A ;* RESERVAR MEMORIA PARA BUFFER DE SONIDO!!!!!
   0036 22r0Ar00      [16]  249 	LD	(#_CANAL_A),HL
   0039 21r7Br00      [10]  250 	LD	HL,#_SOUND_BUFFER_B
   003C 22r0Cr00      [16]  251 	LD	(#_CANAL_B),HL
   003F 21r8Br00      [10]  252 	LD	HL,#_SOUND_BUFFER_C
   0042 22r0Er00      [16]  253 	LD	(#_CANAL_C),HL
   0045 21r9Br00      [10]  254 	LD	HL,#_SOUND_BUFFER_P
   0048 22r36r00      [16]  255 	LD	(#_CANAL_P),HL
                            256 ;TABLA	DE DATOS DEL SELECTOR DEL CANAL DE EFECTOS DE RITMO
                            257 ;---	chan A
   004B 21r59r00      [10]  258 	LD	HL,#_AYREGS+0
   004E 22rB3r00      [16]  259 	LD	(#_SELECT_CANAL_A),HL
   0051 21r5Ar00      [10]  260 	LD	HL,#_AYREGS+0 +1
   0054 22rB5r00      [16]  261 	LD	(#_SELECT_CANAL_A+2),HL
   0057 21r61r00      [10]  262 	LD	HL,#_AYREGS+8
   005A 22rB7r00      [16]  263 	LD	(#_SELECT_CANAL_A+4),HL
   005D 3E B1         [ 7]  264 	LD	A,#0b10110001
   005F 32rB9r00      [13]  265 	LD	(#_SELECT_CANAL_A+6),A
                            266 ;---	chan B
   0062 21r5Br00      [10]  267 	LD	HL,#_AYREGS+2
   0065 22rBAr00      [16]  268 	LD	(#_SELECT_CANAL_B),HL
   0068 21r5Cr00      [10]  269 	LD	HL,#_AYREGS+2 +1
   006B 22rBCr00      [16]  270 	LD	(#_SELECT_CANAL_B+2),HL
   006E 21r62r00      [10]  271 	LD	HL,#_AYREGS+9
   0071 22rBEr00      [16]  272 	LD	(#_SELECT_CANAL_B+4),HL
   0074 3E AA         [ 7]  273 	LD	A,#0b10101010
   0076 32rC0r00      [13]  274 	LD	(#_SELECT_CANAL_B+6),A
                            275 ;---	chan C
   0079 21r5Dr00      [10]  276 	LD	HL,#_AYREGS+4
   007C 22rC1r00      [16]  277 	LD	(#_SELECT_CANAL_C),HL
   007F 21r5Er00      [10]  278 	LD	HL,#_AYREGS+4 +1
   0082 22rC3r00      [16]  279 	LD	(#_SELECT_CANAL_C+2),HL
   0085 21r63r00      [10]  280 	LD	HL,#_AYREGS+10
   0088 22rC5r00      [16]  281 	LD	(#_SELECT_CANAL_C+4),HL
   008B 3E 9C         [ 7]  282 	LD	A,#0b10011100
   008D 32rC7r00      [13]  283 	LD	(#_SELECT_CANAL_C+6),A
                            284 ;	TABLA_DATOS_CANAL_SFX
   0090 21rB3r00      [10]  285 	LD	HL,#_SELECT_CANAL_A
   0093 22rC8r00      [16]  286 	LD	(#_TABLA_DATOS_CANAL_SFX),HL
   0096 21rBAr00      [10]  287 	LD	HL,#_SELECT_CANAL_B
   0099 22rCAr00      [16]  288 	LD	(#_TABLA_DATOS_CANAL_SFX+2),HL
   009C 21rC1r00      [10]  289 	LD	HL,#_SELECT_CANAL_C
   009F 22rCCr00      [16]  290 	LD	(#_TABLA_DATOS_CANAL_SFX+4),HL
   00A2 DD E1         [14]  291 	pop	IX
   00A4 C9            [10]  292 	ret
                            293 ;src\WYZplayer.c:293: }         
                            294 ;src\WYZplayer.c:306: void Player_Pause() __naked
                            295 ;	---------------------------------
                            296 ; Function Player_Pause
                            297 ; ---------------------------------
   00A5                     298 _Player_Pause::
                            299 ;src\WYZplayer.c:335: __endasm;
   00A5                     300 	PLAYER_OFF:
                            301 ;	XOR A
                            302 ;	LD [INTERR],A
                            303 ;	LD [FADE],A ;solo si hay fade out
   00A5 21r00r00      [10]  304 	LD	HL,#_WYZstate
   00A8 CB 8E         [15]  305 	RES	1,(HL)
   00AA                     306 	CLEAR_PSG_BUFFER:
   00AA AF            [ 4]  307 	XOR	A
   00AB 21r49r00      [10]  308 	LD	HL,#_PSG_REG
   00AE 11r4Ar00      [10]  309 	LD	DE,#_PSG_REG+1
   00B1 01 0E 00      [10]  310 	LD	BC,#14
   00B4 77            [ 7]  311 	LD	(HL),A
   00B5 ED B0         [21]  312 	LDIR
   00B7 3E B8         [ 7]  313 	LD	A,#0b10111000 ; **** POR SI ACASO ****
   00B9 32r50r00      [13]  314 	LD	(#_PSG_REG+7),A
   00BC 21r49r00      [10]  315 	LD	HL,#_PSG_REG
   00BF 11r59r00      [10]  316 	LD	DE,#_AYREGS
   00C2 01 0E 00      [10]  317 	LD	BC,#14
   00C5 ED B0         [21]  318 	LDIR
   00C7 C3r0Dr01      [10]  319 	jp	ROUT
                            320 ;src\WYZplayer.c:336: }
                            321 ;src\WYZplayer.c:350: void Player_Resume() __naked
                            322 ;	---------------------------------
                            323 ; Function Player_Resume
                            324 ; ---------------------------------
   00CA                     325 _Player_Resume::
                            326 ;src\WYZplayer.c:357: __endasm;
   00CA 21r00r00      [10]  327 	LD	HL,#_WYZstate
   00CD CB CE         [15]  328 	SET	1,(HL) ;PLAYER ON
   00CF C9            [10]  329 	RET
                            330 ;src\WYZplayer.c:358: }
                            331 ;src\WYZplayer.c:371: void Player_Loop(char loop) __naked
                            332 ;	---------------------------------
                            333 ; Function Player_Loop
                            334 ; ---------------------------------
   00D0                     335 _Player_Loop::
                            336 ;src\WYZplayer.c:399: __endasm;
   00D0 DD E5         [15]  337 	push	IX
   00D2 DD 21 00 00   [14]  338 	ld	IX,#0
   00D6 DD 39         [15]  339 	add	IX,SP
   00D8 DD 7E 04      [19]  340 	ld	A,4(IX)
   00DB CDrE1r00      [17]  341 	call	setLoop
   00DE DD E1         [14]  342 	pop	IX
   00E0 C9            [10]  343 	RET
   00E1                     344 	setLoop:
   00E1 21r00r00      [10]  345 	LD	HL,#_WYZstate
   00E4 B7            [ 4]  346 	or	A
   00E5 28 03         [12]  347 	jr	Z,resetLOOP
   00E7 CB E6         [15]  348 	SET	4,(HL) ;LOOP ON
   00E9 C9            [10]  349 	ret
   00EA                     350 	resetLOOP:
   00EA CB A6         [15]  351 	RES	4,(HL)
   00EC C9            [10]  352 	ret
                            353 ;src\WYZplayer.c:400: }
                            354 ;src\WYZplayer.c:413: void PlayFX(char numSound) __naked
                            355 ;	---------------------------------
                            356 ; Function PlayFX
                            357 ; ---------------------------------
   00ED                     358 _PlayFX::
                            359 ;src\WYZplayer.c:443: __endasm;
   00ED DD E5         [15]  360 	push	IX
   00EF DD 21 00 00   [14]  361 	ld	IX,#0
   00F3 DD 39         [15]  362 	add	IX,sp
   00F5 DD 7E 04      [19]  363 	LD	A,4(IX)
   00F8 CDrFEr00      [17]  364 	CALL	INICIA_SONIDO
   00FB DD E1         [14]  365 	pop	IX
   00FD C9            [10]  366 	ret
                            367 ;INICIA	EL SONIDO No [A]
   00FE                     368 	INICIA_SONIDO:
                            369 ;CP	8 ;SFX SPEECH
                            370 ;JP	Z,SLOOP
   00FE 2ArAFr00      [16]  371 	LD	HL,(#_TABLA_SONIDOS) ;(v SDCC) HL,TABLA_SONIDOS
   0101 CDr01r06      [17]  372 	CALL	EXT_WORD
   0104 22r47r00      [16]  373 	LD	(#_PUNTERO_SONIDO),HL
   0107 21r00r00      [10]  374 	LD	HL,#_WYZstate
   010A CB D6         [15]  375 	SET	2,(HL)
   010C C9            [10]  376 	RET
                            377 ;src\WYZplayer.c:444: } 
                            378 ;src\WYZplayer.c:461: void PlayAY() __naked
                            379 ;	---------------------------------
                            380 ; Function PlayAY
                            381 ; ---------------------------------
   010D                     382 _PlayAY::
                            383 ;src\WYZplayer.c:514: __endasm;
   010D                     384 	ROUT:
                            385 ;Record	register 7 of the AY38910 ----------------------------------------------
                            386 ;collects	the last two bits for joysctick port control
                            387 ;and	adds them to the value of the mixer bits
   010D 3Ar60r00      [13]  388 	ld	A,(#_AYREGS+7)
   0110 E6 3F         [ 7]  389 	and	#0b00111111
   0112 47            [ 4]  390 	ld	B,A
   0113 3E 07         [ 7]  391 	ld	A,#7
   0115 D3 A0         [11]  392 	out	(#0xA0),A
   0117 DB A2         [11]  393 	in	A,(#0xA2)
   0119 E6 C0         [ 7]  394 	and	#0b11000000 ; Mask to catch only the two bits of joys
   011B B0            [ 4]  395 	or	B ; Add B
   011C 32r60r00      [13]  396 	ld	(#_AYREGS+7),A
                            397 ;END	register 7 ----------------------------------------------------------------
   011F 3Ar56r00      [13]  398 	LD	A,(#_PSG_REG+13)
   0122 A7            [ 4]  399 	AND	A ;ES CERO?
   0123 28 03         [12]  400 	JR	Z,NO_BACKUP_ENVOLVENTE
   0125 32r6Ar00      [13]  401 	LD	(#_ENVOLVENTE_BACK),A ;08.13 / GUARDA LA ENVOLVENTE EN EL BACKUP
   0128                     402 	NO_BACKUP_ENVOLVENTE:
   0128 AF            [ 4]  403 	XOR	A
   0129 0E A0         [ 7]  404 	LD	C,#0xA0 ;0xA0
   012B 21r59r00      [10]  405 	LD	HL,#_AYREGS
   012E                     406 	LOUT:
   012E ED 79         [12]  407 	OUT	(C),A
   0130 0C            [ 4]  408 	INC	C
   0131 ED A3         [16]  409 	OUTI
   0133 0D            [ 4]  410 	DEC	C
   0134 3C            [ 4]  411 	INC	A
   0135 FE 0D         [ 7]  412 	CP	#13
   0137 20 F5         [12]  413 	JR	NZ,LOUT
   0139 ED 79         [12]  414 	OUT	(C),A
   013B 7E            [ 7]  415 	LD	A,(HL)
   013C A7            [ 4]  416 	AND	A
   013D C8            [11]  417 	RET	Z
   013E 0C            [ 4]  418 	INC	C
   013F ED 79         [12]  419 	OUT	(C),A
   0141 AF            [ 4]  420 	XOR	A
   0142 32r66r00      [13]  421 	LD	(#_AYREGS+13),A
   0145 32r56r00      [13]  422 	LD	(#_PSG_REG+13),A
   0148 C9            [10]  423 	RET
                            424 ;src\WYZplayer.c:515: }
                            425 ;src\WYZplayer.c:533: void Player_InitSong(char numSong, char loop) __naked
                            426 ;	---------------------------------
                            427 ; Function Player_InitSong
                            428 ; ---------------------------------
   0149                     429 _Player_InitSong::
                            430 ;src\WYZplayer.c:728: __endasm;
   0149 DD E5         [15]  431 	push	IX
   014B DD 21 00 00   [14]  432 	ld	IX,#0
   014F DD 39         [15]  433 	add	IX,sp
   0151 DD 7E 05      [19]  434 	ld	A,5(IX)
   0154 CDrE1r00      [17]  435 	call	setLoop
   0157 DD 7E 04      [19]  436 	LD	A,4(IX)
   015A CDr60r01      [17]  437 	call	CARGA_CANCION
   015D DD E1         [14]  438 	pop	IX
   015F C9            [10]  439 	ret
                            440 ;CARGA	UNA CANCION
                            441 ;IN:[A]=Nº	DE CANCION
   0160                     442 	CARGA_CANCION:
                            443 ;LD	HL,#_SONG
   0160 32r01r00      [13]  444 	LD	(#_SONG),A ;Nº A
   0163 21r00r00      [10]  445 	LD	HL,#_WYZstate ;CARGA CANCION
   0166 CB CE         [15]  446 	SET	1,(HL) ;REPRODUCE CANCION
                            447 ;DECODIFICAR
                            448 ;IN->	WYZstate 0 ON
                            449 ;	SONG
                            450 ;CARGA	CANCION SI/NO
   0168                     451 	DECODE_SONG:
   0168 3Ar01r00      [13]  452 	LD	A,(#_SONG)
                            453 ;LEE	CABECERA DE LA CANCION
                            454 ;BYTE	0=TEMPO
   016B 2ArABr00      [16]  455 	LD	HL,(#_TABLA_SONG) ;(v SDCC) HL,_TABLA_SONG
   016E CDr01r06      [17]  456 	CALL	EXT_WORD
   0171 7E            [ 7]  457 	LD	A,(HL)
   0172 32r02r00      [13]  458 	LD	(#_TEMPO),A
   0175 3D            [ 4]  459 	DEC	A
   0176 32r03r00      [13]  460 	LD	(#_TTEMPO),A
                            461 ;HEADER	BYTE 1
                            462 ;[-|-|-|-|	3-1 | 0 ]
                            463 ;[-|-|-|-|FX	CHN|LOOP]
   0179 23            [ 6]  464 	INC	HL ;LOOP 1=ON/0=OFF?
   017A 7E            [ 7]  465 	LD	A,(HL)
                            466 ;BIT	0,A
                            467 ;JR	Z,NPTJP0
                            468 ;PUSH	HL
                            469 ;LD	HL,#_WYZstate
                            470 ;SET	4,(HL)
                            471 ;POP	HL
                            472 ;SELECCION	DEL CANAL DE EFECTOS DE RITMO
   017B                     473 	NPTJP0:
   017B E6 06         [ 7]  474 	AND	#0b00000110
   017D 1F            [ 4]  475 	RRA
                            476 ;LD	(#_SELECT_CANAL_P),A
   017E E5            [11]  477 	PUSH	HL
   017F 21rC8r00      [10]  478 	LD	HL,#_TABLA_DATOS_CANAL_SFX
   0182 CDr01r06      [17]  479 	CALL	EXT_WORD
   0185 E5            [11]  480 	PUSH	HL
   0186 DD E1         [14]  481 	POP	IX
   0188 DD 5E 00      [19]  482 	LD	E,0(IX)
   018B DD 56 01      [19]  483 	LD	D,1(IX)
   018E ED 53r3Er00   [20]  484 	LD	(#_SFX_L),DE
   0192 DD 5E 02      [19]  485 	LD	E,2(IX)
   0195 DD 56 03      [19]  486 	LD	D,3(IX)
   0198 ED 53r40r00   [20]  487 	LD	(#_SFX_H),DE
   019C DD 5E 04      [19]  488 	LD	E,4(IX)
   019F DD 56 05      [19]  489 	LD	D,5(IX)
   01A2 ED 53r42r00   [20]  490 	LD	(#_SFX_V),DE
   01A6 DD 7E 06      [19]  491 	LD	A,6(IX)
   01A9 32r44r00      [13]  492 	LD	(#_SFX_MIX),A
   01AC E1            [10]  493 	POP	HL
   01AD 23            [ 6]  494 	INC	HL ;2 BYTES RESERVADOS
   01AE 23            [ 6]  495 	INC	HL
   01AF 23            [ 6]  496 	INC	HL
                            497 ;BUSCA	Y GUARDA INICIO DE LOS CANALES EN EL MODULO MUS (OPTIMIZAR)
                            498 ;AÑADE	OFFSET DEL LOOP
   01B0 E5            [11]  499 	PUSH	HL ;IX INICIO OFFSETS LOOP POR CANAL
   01B1 DD E1         [14]  500 	POP	IX
   01B3 11 08 00      [10]  501 	LD	DE,#0x0008 ;HASTA INICIO DEL CANAL A
   01B6 19            [11]  502 	ADD	HL,DE
   01B7 22r1Cr00      [16]  503 	LD	(#_PUNTERO_P_DECA),HL ;GUARDA PUNTERO INICIO CANAL
   01BA DD 5E 00      [19]  504 	LD	E,(IX)
   01BD DD 56 01      [19]  505 	LD	D,1(IX)
   01C0 19            [11]  506 	ADD	HL,DE
   01C1 22r2Er00      [16]  507 	LD	(#_PUNTERO_L_DECA),HL ;GUARDA PUNTERO INICIO LOOP
   01C4 CDr39r02      [17]  508 	CALL	BGICMODBC1
   01C7 22r1Er00      [16]  509 	LD	(#_PUNTERO_P_DECB),HL
   01CA DD 5E 02      [19]  510 	LD	E,2(IX)
   01CD DD 56 03      [19]  511 	LD	D,3(IX)
   01D0 19            [11]  512 	ADD	HL,DE
   01D1 22r30r00      [16]  513 	LD	(#_PUNTERO_L_DECB),HL
   01D4 CDr39r02      [17]  514 	CALL	BGICMODBC1
   01D7 22r20r00      [16]  515 	LD	(#_PUNTERO_P_DECC),HL
   01DA DD 5E 04      [19]  516 	LD	E,4(IX)
   01DD DD 56 05      [19]  517 	LD	D,5(IX)
   01E0 19            [11]  518 	ADD	HL,DE
   01E1 22r32r00      [16]  519 	LD	(#_PUNTERO_L_DECC),HL
   01E4 CDr39r02      [17]  520 	CALL	BGICMODBC1
   01E7 22r38r00      [16]  521 	LD	(#_PUNTERO_P_DECP),HL
   01EA DD 5E 06      [19]  522 	LD	E,6(IX)
   01ED DD 56 07      [19]  523 	LD	D,7(IX)
   01F0 19            [11]  524 	ADD	HL,DE
   01F1 22r3Cr00      [16]  525 	LD	(#_PUNTERO_L_DECP),HL
                            526 ;LEE	DATOS DE LAS NOTAS
                            527 ;[|][|||||]	LONGITUD\NOTA
   01F4                     528 	INIT_DECODER:
   01F4 ED 5Br0Ar00   [20]  529 	LD	DE,(#_CANAL_A)
   01F8 ED 53r04r00   [20]  530 	LD	(#_PUNTERO_A),DE
   01FC 2Ar1Cr00      [16]  531 	LD	HL,(#_PUNTERO_P_DECA)
   01FF CDr4Cr03      [17]  532 	CALL	DECODE_CANAL ;CANAL A
   0202 22r22r00      [16]  533 	LD	(#_PUNTERO_DECA),HL
   0205 ED 5Br0Cr00   [20]  534 	LD	DE,(#_CANAL_B)
   0209 ED 53r06r00   [20]  535 	LD	(#_PUNTERO_B),DE
   020D 2Ar1Er00      [16]  536 	LD	HL,(#_PUNTERO_P_DECB)
   0210 CDr4Cr03      [17]  537 	CALL	DECODE_CANAL ;CANAL B
   0213 22r24r00      [16]  538 	LD	(#_PUNTERO_DECB),HL
   0216 ED 5Br0Er00   [20]  539 	LD	DE,(#_CANAL_C)
   021A ED 53r08r00   [20]  540 	LD	(#_PUNTERO_C),DE
   021E 2Ar20r00      [16]  541 	LD	HL,(#_PUNTERO_P_DECC)
   0221 CDr4Cr03      [17]  542 	CALL	DECODE_CANAL ;CANAL C
   0224 22r26r00      [16]  543 	LD	(#_PUNTERO_DECC),HL
   0227 ED 5Br36r00   [20]  544 	LD	DE,(#_CANAL_P)
   022B ED 53r34r00   [20]  545 	LD	(#_PUNTERO_P),DE
   022F 2Ar38r00      [16]  546 	LD	HL,(#_PUNTERO_P_DECP)
   0232 CDr4Cr03      [17]  547 	CALL	DECODE_CANAL ;CANAL P (FX)
   0235 22r3Ar00      [16]  548 	LD	(#_PUNTERO_DECP),HL
   0238 C9            [10]  549 	RET
                            550 ;BUSCA	INICIO DEL CANAL
   0239                     551 	BGICMODBC1:
   0239 AF            [ 4]  552 	XOR	A ;BUSCA EL BYTE 0
   023A 1E 3F         [ 7]  553 	LD	E,#0x3F ;CODIGO INSTRUMENTO 0
   023C 06 FF         [ 7]  554 	LD	B,#0xFF ;EL MODULO DEBE TENER UNA LONGITUD MENOR DE $FF00 ... o_O!
   023E ED B1         [21]  555 	CPIR
   0240 2B            [ 6]  556 	DEC	HL
   0241 2B            [ 6]  557 	DEC	HL
   0242 7B            [ 4]  558 	LD	A,E ;ES EL INSTRUMENTO 0??
   0243 BE            [ 7]  559 	CP	(HL)
   0244 23            [ 6]  560 	INC	HL
   0245 23            [ 6]  561 	INC	HL
   0246 28 F1         [12]  562 	JR	Z,BGICMODBC1
   0248 2B            [ 6]  563 	DEC	HL
   0249 2B            [ 6]  564 	DEC	HL
   024A 2B            [ 6]  565 	DEC	HL
   024B 7B            [ 4]  566 	LD	A,E ;ES VOLUMEN 0??
   024C BE            [ 7]  567 	CP	(HL)
   024D 23            [ 6]  568 	INC	HL
   024E 23            [ 6]  569 	INC	HL
   024F 23            [ 6]  570 	INC	HL
   0250 28 E7         [12]  571 	JR	Z,BGICMODBC1
   0252 C9            [10]  572 	RET
                            573 ;src\WYZplayer.c:729: }
                            574 ;src\WYZplayer.c:748: void Player_Decode() __naked
                            575 ;	---------------------------------
                            576 ; Function Player_Decode
                            577 ; ---------------------------------
   0253                     578 _Player_Decode::
                            579 ;src\WYZplayer.c:1441: __endasm;
   0253                     580 	INICIO:
   0253 DD E5         [15]  581 	push	IX
                            582 ;	CALL ROUT
                            583 ;	CALL MIXER
   0255 21r49r00      [10]  584 	LD	HL,#_PSG_REG
   0258 11r59r00      [10]  585 	LD	DE,#_AYREGS
   025B 01 0E 00      [10]  586 	LD	BC,#14
   025E ED B0         [21]  587 	LDIR
   0260 CDr69r02      [17]  588 	CALL	REPRODUCE_SONIDO
   0263 CDrDEr02      [17]  589 	CALL	PLAY
   0266 DD E1         [14]  590 	pop	IX
   0268 C9            [10]  591 	RET
                            592 ;REPRODUCE	EFECTOS DE SONIDO
   0269                     593 	REPRODUCE_SONIDO:
   0269 21r00r00      [10]  594 	LD	HL,#_WYZstate
   026C CB 56         [12]  595 	BIT	2,(HL) ;ESTA ACTIVADO EL EFECTO?
   026E C8            [11]  596 	RET	Z
   026F 2Ar47r00      [16]  597 	LD	HL,(#_PUNTERO_SONIDO)
   0272 7E            [ 7]  598 	LD	A,(HL)
   0273 FE FF         [ 7]  599 	CP	#0xFF
   0275 28 53         [12]  600 	JR	Z,FIN_SONIDO
   0277 ED 5Br3Er00   [20]  601 	LD	DE,(#_SFX_L)
   027B 12            [ 7]  602 	LD	(DE),A
   027C 23            [ 6]  603 	INC	HL
   027D 7E            [ 7]  604 	LD	A,(HL)
   027E 0F            [ 4]  605 	RRCA
   027F 0F            [ 4]  606 	RRCA
   0280 0F            [ 4]  607 	RRCA
   0281 0F            [ 4]  608 	RRCA
   0282 E6 0F         [ 7]  609 	AND	#0b00001111
   0284 ED 5Br40r00   [20]  610 	LD	DE,(#_SFX_H)
   0288 12            [ 7]  611 	LD	(DE),A
   0289 7E            [ 7]  612 	LD	A,(HL)
   028A E6 0F         [ 7]  613 	AND	#0b00001111
   028C ED 5Br42r00   [20]  614 	LD	DE,(#_SFX_V)
   0290 12            [ 7]  615 	LD	(DE),A
   0291 23            [ 6]  616 	INC	HL
   0292 7E            [ 7]  617 	LD	A,(HL)
   0293 47            [ 4]  618 	LD	B,A
   0294 CB 7F         [ 8]  619 	BIT	7,A ;09.08.13 BIT MAS SIGINIFICATIVO ACTIVA ENVOLVENTES
   0296 28 16         [12]  620 	JR	Z,NO_ENVOLVENTES_SONIDO
   0298 3E 12         [ 7]  621 	LD	A,#0x12
   029A 12            [ 7]  622 	LD	(DE),A
   029B 23            [ 6]  623 	INC	HL
   029C 7E            [ 7]  624 	LD	A,(HL)
   029D 32r64r00      [13]  625 	LD	(#_AYREGS+11),A
   02A0 23            [ 6]  626 	INC	HL
   02A1 7E            [ 7]  627 	LD	A,(HL)
   02A2 32r65r00      [13]  628 	LD	(#_AYREGS+11 +1),A
   02A5 23            [ 6]  629 	INC	HL
   02A6 7E            [ 7]  630 	LD	A,(HL)
   02A7 FE 01         [ 7]  631 	CP	#1
   02A9 28 03         [12]  632 	JR	Z,NO_ENVOLVENTES_SONIDO ;NO ESCRIBE LA ENVOLVENTE SI SU VALOR ES 1
   02AB 32r66r00      [13]  633 	LD	(#_AYREGS+13),A
   02AE                     634 	NO_ENVOLVENTES_SONIDO:
   02AE 78            [ 4]  635 	LD	A,B
   02AF CB BF         [ 8]  636 	RES	7,A
   02B1 A7            [ 4]  637 	AND	A
   02B2 28 08         [12]  638 	JR	Z,NO_RUIDO
   02B4 32r5Fr00      [13]  639 	LD	(#_AYREGS+6),A
   02B7 3Ar44r00      [13]  640 	LD	A,(#_SFX_MIX)
   02BA 18 06         [12]  641 	JR	SI_RUIDO
   02BC                     642 	NO_RUIDO:
   02BC AF            [ 4]  643 	XOR	A
   02BD 32r5Fr00      [13]  644 	LD	(#_AYREGS+6),A
   02C0 3E B8         [ 7]  645 	LD	A,#0b10111000
   02C2                     646 	SI_RUIDO:
   02C2 32r60r00      [13]  647 	LD	(#_AYREGS+7),A
   02C5 23            [ 6]  648 	INC	HL
   02C6 22r47r00      [16]  649 	LD	(#_PUNTERO_SONIDO),HL
   02C9 C9            [10]  650 	RET
   02CA                     651 	FIN_SONIDO:
   02CA 21r00r00      [10]  652 	LD	HL,#_WYZstate
   02CD CB 96         [15]  653 	RES	2,(HL)
   02CF 3Ar6Ar00      [13]  654 	LD	A,(#_ENVOLVENTE_BACK) ;NO RESTAURA LA ENVOLVENTE SI ES 0
   02D2 A7            [ 4]  655 	AND	A
   02D3 28 03         [12]  656 	JR	Z,FIN_NOPLAYER
                            657 ;xor	a
   02D5 32r66r00      [13]  658 	LD	(#_AYREGS+13),A ;08.13 RESTAURA LA ENVOLVENTE TRAS EL SFX
   02D8                     659 	FIN_NOPLAYER:
   02D8 3E B8         [ 7]  660 	LD	A,#0b10111000
   02DA 32r60r00      [13]  661 	LD	(#_AYREGS+7),A
   02DD C9            [10]  662 	RET
   02DE                     663 	PLAY:
   02DE 21r00r00      [10]  664 	LD	HL,#_WYZstate ;PLAY BIT 1 ON?
   02E1 CB 4E         [12]  665 	BIT	1,(HL)
   02E3 C8            [11]  666 	RET	Z
                            667 ;TEMPO
   02E4 21r03r00      [10]  668 	LD	HL,#_TTEMPO ;CONTADOR TEMPO
   02E7 34            [11]  669 	INC	(HL)
   02E8 3Ar02r00      [13]  670 	LD	A,(#_TEMPO)
   02EB BE            [ 7]  671 	CP	(HL)
   02EC 20 33         [12]  672 	JR	NZ,PAUTAS
   02EE 36 00         [10]  673 	LD	(HL),#0
                            674 ;INTERPRETA
   02F0 FD 21r49r00   [14]  675 	LD	IY,#_PSG_REG
   02F4 DD 21r04r00   [14]  676 	LD	IX,#_PUNTERO_A
   02F8 01r51r00      [10]  677 	LD	BC,#_PSG_REG+8
   02FB CDrBDr03      [17]  678 	CALL	LOCALIZA_NOTA
   02FE FD 21r4Br00   [14]  679 	LD	IY,#_PSG_REG+2
   0302 DD 21r06r00   [14]  680 	LD	IX,#_PUNTERO_B
   0306 01r52r00      [10]  681 	LD	BC,#_PSG_REG+9
   0309 CDrBDr03      [17]  682 	CALL	LOCALIZA_NOTA
   030C FD 21r4Dr00   [14]  683 	LD	IY,#_PSG_REG+4
   0310 DD 21r08r00   [14]  684 	LD	IX,#_PUNTERO_C
   0314 01r53r00      [10]  685 	LD	BC,#_PSG_REG+10
   0317 CDrBDr03      [17]  686 	CALL	LOCALIZA_NOTA
   031A DD 21r34r00   [14]  687 	LD	IX,#_PUNTERO_P ;EL CANAL DE EFECTOS ENMASCARA OTRO CANAL
   031E CDrB9r04      [17]  688 	CALL	LOCALIZA_EFECTO
   0321                     689 	PAUTAS:
   0321 FD 21r49r00   [14]  690 	LD	IY,#_PSG_REG+0
   0325 DD 21r10r00   [14]  691 	LD	IX,#_PUNTERO_P_A
   0329 21r51r00      [10]  692 	LD	HL,#_PSG_REG+8
   032C CDr01r05      [17]  693 	CALL	PAUTA ;PAUTA CANAL A
   032F FD 21r4Br00   [14]  694 	LD	IY,#_PSG_REG+2
   0333 DD 21r12r00   [14]  695 	LD	IX,#_PUNTERO_P_B
   0337 21r52r00      [10]  696 	LD	HL,#_PSG_REG+9
   033A CDr01r05      [17]  697 	CALL	PAUTA ;PAUTA CANAL B
   033D FD 21r4Dr00   [14]  698 	LD	IY,#_PSG_REG+4
   0341 DD 21r14r00   [14]  699 	LD	IX,#_PUNTERO_P_C
   0345 21r53r00      [10]  700 	LD	HL,#_PSG_REG+10
   0348 CDr01r05      [17]  701 	CALL	PAUTA ;PAUTA CANAL C
   034B C9            [10]  702 	RET
                            703 ;DECODIFICA	NOTAS DE UN CANAL
                            704 ;IN	(DE)=DIRECCION DESTINO
                            705 ;NOTA=0	FIN CANAL
                            706 ;NOTA=1	SILENCIO
                            707 ;NOTA=2	PUNTILLO
                            708 ;NOTA=3	COMANDO I
   034C                     709 	DECODE_CANAL:
   034C 7E            [ 7]  710 	LD	A,(HL)
   034D A7            [ 4]  711 	AND	A ;FIN DEL CANAL?
   034E 28 55         [12]  712 	JR	Z,FIN_DEC_CANAL
   0350 CDrAAr03      [17]  713 	CALL	GETLEN
   0353 FE 01         [ 7]  714 	CP	#0b00000001 ;ES SILENCIO?
   0355 20 04         [12]  715 	JR	NZ,NO_SILENCIO
   0357 CB F7         [ 8]  716 	SET	6,A
   0359 18 3D         [12]  717 	JR	NO_MODIFICA
   035B                     718 	NO_SILENCIO:
   035B FE 3E         [ 7]  719 	CP	#0b00111110 ;ES PUNTILLO?
   035D 20 06         [12]  720 	JR	NZ,NO_PUNTILLO
   035F B7            [ 4]  721 	OR	A
   0360 CB 08         [ 8]  722 	RRC	B
   0362 AF            [ 4]  723 	XOR	A
   0363 18 33         [12]  724 	JR	NO_MODIFICA
   0365                     725 	NO_PUNTILLO:
   0365 FE 3F         [ 7]  726 	CP	#0b00111111 ;ES COMANDO?
   0367 20 2F         [12]  727 	JR	NZ,NO_MODIFICA
   0369 CB 40         [ 8]  728 	BIT	0,B ;COMADO=INSTRUMENTO?
   036B 28 0F         [12]  729 	JR	Z,NO_INSTRUMENTO
   036D 3E C1         [ 7]  730 	LD	A,#0b11000001 ;CODIGO DE INSTRUMENTO
   036F 12            [ 7]  731 	LD	(DE),A
   0370 23            [ 6]  732 	INC	HL
   0371 13            [ 6]  733 	INC	DE
   0372 7E            [ 7]  734 	LD	A,(HL) ;Nº DE INSTRUMENTO
   0373 12            [ 7]  735 	LD	(DE),A
   0374 13            [ 6]  736 	INC	DE
   0375 23            [ 6]  737 	INC	HL
   0376 7E            [ 7]  738 	LD	A,(HL) ;VOLUMEN RELATIVO DEL INSTRUMENTO
   0377 12            [ 7]  739 	LD	(DE),A
   0378 13            [ 6]  740 	INC	DE
   0379 23            [ 6]  741 	INC	HL
   037A 18 D0         [12]  742 	JR	DECODE_CANAL
   037C                     743 	NO_INSTRUMENTO:
   037C CB 50         [ 8]  744 	BIT	2,B
   037E 28 0B         [12]  745 	JR	Z,NO_ENVOLVENTE
   0380 3E C4         [ 7]  746 	LD	A,#0b11000100 ;CODIGO ENVOLVENTE
   0382 12            [ 7]  747 	LD	(DE),A
   0383 13            [ 6]  748 	INC	DE
   0384 23            [ 6]  749 	INC	HL
   0385 7E            [ 7]  750 	LD	A,(HL)
   0386 12            [ 7]  751 	LD	(DE),A
   0387 13            [ 6]  752 	INC	DE
   0388 23            [ 6]  753 	INC	HL
   0389 18 C1         [12]  754 	JR	DECODE_CANAL
   038B                     755 	NO_ENVOLVENTE:
   038B CB 48         [ 8]  756 	BIT	1,B
   038D 28 09         [12]  757 	JR	Z,NO_MODIFICA
   038F 3E C2         [ 7]  758 	LD	A,#0b11000010 ;CODIGO EFECTO
   0391 12            [ 7]  759 	LD	(DE),A
   0392 23            [ 6]  760 	INC	HL
   0393 13            [ 6]  761 	INC	DE
   0394 7E            [ 7]  762 	LD	A,(HL)
   0395 CDrAAr03      [17]  763 	CALL	GETLEN
   0398                     764 	NO_MODIFICA:
   0398 12            [ 7]  765 	LD	(DE),A
   0399 13            [ 6]  766 	INC	DE
   039A AF            [ 4]  767 	XOR	A
   039B 10 FB         [13]  768 	DJNZ	NO_MODIFICA
   039D CB FF         [ 8]  769 	SET	7,A
   039F CB C7         [ 8]  770 	SET	0,A
   03A1 12            [ 7]  771 	LD	(DE),A
   03A2 13            [ 6]  772 	INC	DE
   03A3 23            [ 6]  773 	INC	HL
   03A4 C9            [10]  774 	RET	;** JR DECODE_CANAL
   03A5                     775 	FIN_DEC_CANAL:
   03A5 CB FF         [ 8]  776 	SET	7,A
   03A7 12            [ 7]  777 	LD	(DE),A
   03A8 13            [ 6]  778 	INC	DE
   03A9 C9            [10]  779 	RET
   03AA                     780 	GETLEN:
   03AA 47            [ 4]  781 	LD	B,A
   03AB E6 3F         [ 7]  782 	AND	#0b00111111
   03AD F5            [11]  783 	PUSH	AF
   03AE 78            [ 4]  784 	LD	A,B
   03AF E6 C0         [ 7]  785 	AND	#0b11000000
   03B1 07            [ 4]  786 	RLCA
   03B2 07            [ 4]  787 	RLCA
   03B3 3C            [ 4]  788 	INC	A
   03B4 47            [ 4]  789 	LD	B,A
   03B5 3E 80         [ 7]  790 	LD	A,#0b10000000
   03B7                     791 	DCBC0:
   03B7 07            [ 4]  792 	RLCA
   03B8 10 FD         [13]  793 	DJNZ	DCBC0
   03BA 47            [ 4]  794 	LD	B,A
   03BB F1            [10]  795 	pop	AF
   03BC C9            [10]  796 	ret
                            797 ;LOCALIZA	NOTA CANAL A
                            798 ;IN	[PUNTERO_A]
                            799 ;LOCALIZA	NOTA CANAL A
                            800 ;IN	[PUNTERO_A]
   03BD                     801 	LOCALIZA_NOTA:
   03BD DD 6E 00      [19]  802 	LD	L,_PUNTERO_A - _PUNTERO_A(IX) ;HL=[PUNTERO_A_C_B]
   03C0 DD 66 01      [19]  803 	LD	H,_PUNTERO_A - _PUNTERO_A+1(IX) ;
   03C3 7E            [ 7]  804 	LD	A,(HL)
   03C4 E6 C0         [ 7]  805 	AND	#0b11000000 ;COMANDO?
   03C6 FE C0         [ 7]  806 	CP	#0b11000000
   03C8 20 6B         [12]  807 	JR	NZ,LNJP0
                            808 ;BIT[0]=INSTRUMENTO
   03CA                     809 	COMANDOS:
   03CA 7E            [ 7]  810 	LD	A,(HL)
   03CB CB 47         [ 8]  811 	BIT	0,A ;INSTRUMENTO
   03CD 28 40         [12]  812 	JR	Z,COM_EFECTO
   03CF 23            [ 6]  813 	INC	HL
   03D0 7E            [ 7]  814 	LD	A,(HL) ;Nº DE PAUTA
   03D1 23            [ 6]  815 	INC	HL
   03D2 5E            [ 7]  816 	LD	E,(HL)
   03D3 E5            [11]  817 	PUSH	HL ;TEMPO
   03D4 21r02r00      [10]  818 	LD	HL,#_TEMPO
   03D7 CB 6B         [ 8]  819 	BIT	5,E
   03D9 28 01         [12]  820 	JR	Z,NO_DEC_TEMPO
   03DB 35            [11]  821 	DEC	(HL)
   03DC                     822 	NO_DEC_TEMPO:
   03DC CB 73         [ 8]  823 	BIT	6,E
   03DE 28 01         [12]  824 	JR	Z,NO_INC_TEMPO
   03E0 34            [11]  825 	INC	(HL)
   03E1                     826 	NO_INC_TEMPO:
   03E1 CB AB         [ 8]  827 	RES	5,E ;SIEMPRE RESETEA LOS BITS DE TEMPO
   03E3 CB B3         [ 8]  828 	RES	6,E
   03E5 E1            [10]  829 	POP	HL
   03E6 DD 73 25      [19]  830 	LD	_VOL_INST_A - _PUNTERO_A(IX),E ;REGISTRO DEL VOLUMEN RELATIVO
   03E9 23            [ 6]  831 	INC	HL
   03EA DD 75 00      [19]  832 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;
   03ED DD 74 01      [19]  833 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   03F0 2ArADr00      [16]  834 	LD	HL,(#_TABLA_PAUTAS) ;(v sdcc) HL,#_TABLA_PAUTAS
   03F3 CDr01r06      [17]  835 	CALL	EXT_WORD
   03F6 DD 75 12      [19]  836 	LD	_PUNTERO_P_A0 - _PUNTERO_A(IX),L
   03F9 DD 74 13      [19]  837 	LD	_PUNTERO_P_A0 - _PUNTERO_A+1(IX),H
   03FC DD 75 0C      [19]  838 	LD	_PUNTERO_P_A - _PUNTERO_A(IX),L
   03FF DD 74 0D      [19]  839 	LD	_PUNTERO_P_A - _PUNTERO_A+1(IX),H
   0402 69            [ 4]  840 	LD	L,C
   0403 60            [ 4]  841 	LD	H,B
   0404 CB A6         [15]  842 	RES	4,(HL) ;APAGA EFECTO ENVOLVENTE
   0406 AF            [ 4]  843 	XOR	A
   0407 32r66r00      [13]  844 	LD	(#_AYREGS+13),A
   040A 32r56r00      [13]  845 	LD	(#_PSG_REG+13),A
                            846 ;LD	[ENVOLVENTE_BACK],A ;08.13 RESETEA EL BACKUP DE LA ENVOLVENTE
   040D 18 AE         [12]  847 	JR	LOCALIZA_NOTA
   040F                     848 	COM_EFECTO:
   040F CB 4F         [ 8]  849 	BIT	1,A ;EFECTO DE SONIDO
   0411 28 0D         [12]  850 	JR	Z,COM_ENVOLVENTE
   0413 23            [ 6]  851 	INC	HL
   0414 7E            [ 7]  852 	LD	A,(HL)
   0415 23            [ 6]  853 	INC	HL
   0416 DD 75 00      [19]  854 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;
   0419 DD 74 01      [19]  855 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   041C CDrFEr00      [17]  856 	CALL	INICIA_SONIDO
   041F C9            [10]  857 	RET
   0420                     858 	COM_ENVOLVENTE:
   0420 CB 57         [ 8]  859 	BIT	2,A
   0422 C8            [11]  860 	RET	Z ;IGNORA - ERROR
   0423 23            [ 6]  861 	INC	HL
   0424 7E            [ 7]  862 	LD	A,(HL) ;CARGA CODIGO DE ENVOLVENTE
   0425 32r69r00      [13]  863 	LD	(#_ENVOLVENTE),A
   0428 23            [ 6]  864 	INC	HL
   0429 DD 75 00      [19]  865 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;
   042C DD 74 01      [19]  866 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   042F 69            [ 4]  867 	LD	L,C
   0430 60            [ 4]  868 	LD	H,B
   0431 36 10         [10]  869 	LD	(HL),#0b00010000 ;ENCIENDE EFECTO ENVOLVENTE
   0433 18 88         [12]  870 	JR	LOCALIZA_NOTA
   0435                     871 	LNJP0:
   0435 7E            [ 7]  872 	LD	A,(HL)
   0436 23            [ 6]  873 	INC	HL
   0437 CB 7F         [ 8]  874 	BIT	7,A
   0439 28 3D         [12]  875 	JR	Z,NO_FIN_CANAL_A ;
   043B CB 47         [ 8]  876 	BIT	0,A
   043D 28 20         [12]  877 	JR	Z,FIN_CANAL_A
   043F                     878 	FIN_NOTA_A:
   043F DD 5E 06      [19]  879 	LD	E,_CANAL_A - _PUNTERO_A(IX)
   0442 DD 56 07      [19]  880 	LD	D,_CANAL_A - _PUNTERO_A+1(IX) ;PUNTERO BUFFER AL INICIO
   0445 DD 73 00      [19]  881 	LD	_PUNTERO_A - _PUNTERO_A(IX),E ;
   0448 DD 72 01      [19]  882 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),D ;
   044B DD 6E 1E      [19]  883 	LD	L,_PUNTERO_DECA - _PUNTERO_A(IX) ;CARGA PUNTERO DECODER
   044E DD 66 1F      [19]  884 	LD	H,_PUNTERO_DECA - _PUNTERO_A+1(IX)
   0451 C5            [11]  885 	PUSH	BC
   0452 CDr4Cr03      [17]  886 	CALL	DECODE_CANAL ;DECODIFICA CANAL
   0455 C1            [10]  887 	POP	BC
   0456 DD 75 1E      [19]  888 	LD	_PUNTERO_DECA - _PUNTERO_A(IX),L ;GUARDA PUNTERO DECODER
   0459 DD 74 1F      [19]  889 	LD	_PUNTERO_DECA - _PUNTERO_A+1(IX),H
   045C C3rBDr03      [10]  890 	JP	LOCALIZA_NOTA
   045F                     891 	FIN_CANAL_A:
   045F 21r00r00      [10]  892 	LD	HL,#_WYZstate ;LOOP?
   0462 CB 66         [12]  893 	BIT	4,(HL)
   0464 20 04         [12]  894 	JR	NZ,FCA_CONT
   0466 F1            [10]  895 	POP	AF
   0467 C3rA5r00      [10]  896 	JP	PLAYER_OFF
   046A                     897 	FCA_CONT:
   046A DD 6E 2A      [19]  898 	LD	L,_PUNTERO_L_DECA - _PUNTERO_A(IX) ;CARGA PUNTERO INICIAL DECODER
   046D DD 66 2B      [19]  899 	LD	H,_PUNTERO_L_DECA - _PUNTERO_A+1(IX)
   0470 DD 75 1E      [19]  900 	LD	_PUNTERO_DECA - _PUNTERO_A(IX),L
   0473 DD 74 1F      [19]  901 	LD	_PUNTERO_DECA - _PUNTERO_A+1(IX),H
   0476 18 C7         [12]  902 	JR	FIN_NOTA_A
   0478                     903 	NO_FIN_CANAL_A:
   0478 DD 75 00      [19]  904 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;[PUNTERO_A_B_C]=HL GUARDA PUNTERO
   047B DD 74 01      [19]  905 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   047E A7            [ 4]  906 	AND	A ;NO REPRODUCE NOTA SI NOTA=0
   047F 28 37         [12]  907 	JR	Z,FIN_RUTINA
   0481 CB 77         [ 8]  908 	BIT	6,A ;SILENCIO?
   0483 28 21         [12]  909 	JR	Z,NO_SILENCIO_A
   0485 0A            [ 7]  910 	LD	A,(BC)
   0486 E6 10         [ 7]  911 	AND	#0b00010000
   0488 20 09         [12]  912 	JR	NZ,SILENCIO_ENVOLVENTE
   048A AF            [ 4]  913 	XOR	A
   048B 02            [ 7]  914 	LD	(BC),A ;RESET VOLUMEN DEL CORRESPODIENTE CHIP
   048C FD 77 00      [19]  915 	LD	0(IY),A
   048F FD 77 01      [19]  916 	LD	1(IY),A
   0492 C9            [10]  917 	RET
   0493                     918 	SILENCIO_ENVOLVENTE:
   0493 3E FF         [ 7]  919 	LD	A,#0xFF
   0495 32r54r00      [13]  920 	LD	(#_PSG_REG+11),A
   0498 32r55r00      [13]  921 	LD	(#_PSG_REG+11 +1),A
   049B AF            [ 4]  922 	XOR	A
   049C 32r56r00      [13]  923 	LD	(#_PSG_REG+13),A
   049F FD 77 00      [19]  924 	LD	0(IY),A
   04A2 FD 77 01      [19]  925 	LD	1(IY),A
   04A5 C9            [10]  926 	RET
   04A6                     927 	NO_SILENCIO_A:
   04A6 DD 77 24      [19]  928 	LD	_REG_NOTA_A - _PUNTERO_A(IX),A ;REGISTRO DE LA NOTA DEL CANAL
   04A9 CDrA1r05      [17]  929 	CALL	NOTA ;REPRODUCE NOTA
   04AC DD 6E 12      [19]  930 	LD	L,_PUNTERO_P_A0 - _PUNTERO_A(IX) ;HL=[PUNTERO_P_A0] RESETEA PAUTA
   04AF DD 66 13      [19]  931 	LD	H,_PUNTERO_P_A0 - _PUNTERO_A+1(IX)
   04B2 DD 75 0C      [19]  932 	LD	_PUNTERO_P_A - _PUNTERO_A(IX),L ;[PUNTERO_P_A]=HL
   04B5 DD 74 0D      [19]  933 	LD	_PUNTERO_P_A - _PUNTERO_A+1(IX),H
   04B8                     934 	FIN_RUTINA:
   04B8 C9            [10]  935 	RET
                            936 ;LOCALIZA	EFECTO
                            937 ;IN	HL=[PUNTERO_P]
   04B9                     938 	LOCALIZA_EFECTO:
   04B9 DD 6E 00      [19]  939 	LD	L,0(IX) ;HL=[PUNTERO_P]
   04BC DD 66 01      [19]  940 	LD	H,1(IX)
   04BF 7E            [ 7]  941 	LD	A,(HL)
   04C0 FE C2         [ 7]  942 	CP	#0b11000010
   04C2 20 0D         [12]  943 	JR	NZ,LEJP0
   04C4 23            [ 6]  944 	INC	HL
   04C5 7E            [ 7]  945 	LD	A,(HL)
   04C6 23            [ 6]  946 	INC	HL
   04C7 DD 75 00      [19]  947 	LD	0(IX),L
   04CA DD 74 01      [19]  948 	LD	1(IX),H
   04CD CDrFEr00      [17]  949 	CALL	INICIA_SONIDO
   04D0 C9            [10]  950 	RET
   04D1                     951 	LEJP0:
   04D1 23            [ 6]  952 	INC	HL
   04D2 CB 7F         [ 8]  953 	BIT	7,A
   04D4 28 24         [12]  954 	JR	Z,NO_FIN_CANAL_P ;
   04D6 CB 47         [ 8]  955 	BIT	0,A
   04D8 28 18         [12]  956 	JR	Z,FIN_CANAL_P
   04DA                     957 	FIN_NOTA_P:
   04DA ED 5Br36r00   [20]  958 	LD	DE,(#_CANAL_P)
   04DE DD 73 00      [19]  959 	LD	0(IX),E
   04E1 DD 72 01      [19]  960 	LD	1(IX),D
   04E4 2Ar3Ar00      [16]  961 	LD	HL,(#_PUNTERO_DECP) ;CARGA PUNTERO DECODER
   04E7 C5            [11]  962 	PUSH	BC
   04E8 CDr4Cr03      [17]  963 	CALL	DECODE_CANAL ;DECODIFICA CANAL
   04EB C1            [10]  964 	POP	BC
   04EC 22r3Ar00      [16]  965 	LD	(#_PUNTERO_DECP),HL ;GUARDA PUNTERO DECODER
   04EF C3rB9r04      [10]  966 	JP	LOCALIZA_EFECTO
   04F2                     967 	FIN_CANAL_P:
   04F2 2Ar3Cr00      [16]  968 	LD	HL,(#_PUNTERO_L_DECP) ;CARGA PUNTERO INICIAL DECODER
   04F5 22r3Ar00      [16]  969 	LD	(#_PUNTERO_DECP),HL
   04F8 18 E0         [12]  970 	JR	FIN_NOTA_P
   04FA                     971 	NO_FIN_CANAL_P:
   04FA DD 75 00      [19]  972 	LD	0(IX),L ;[PUNTERO_A_B_C]=HL GUARDA PUNTERO
   04FD DD 74 01      [19]  973 	LD	1(IX),H
   0500 C9            [10]  974 	RET
                            975 ;	PAUTA DE LOS 3 CANALES
                            976 ;	IN:[IX]:PUNTERO DE LA PAUTA
                            977 ;	(HL):REGISTRO DE VOLUMEN
                            978 ;	[IY]:REGISTROS DE FRECUENCIA
                            979 ;	FORMATO PAUTA
                            980 ;	7 6 5 4 3-0 3-0
                            981 ;	BYTE 1 [LOOP|OCT-1|OCT+1|ORNMT|VOL] - BYTE 2 [ | | | |PITCH/NOTA]
   0501                     982 	PAUTA:
   0501 CB 66         [12]  983 	BIT	4,(HL) ;SI LA ENVOLVENTE ESTA ACTIVADA NO ACTUA PAUTA
   0503 C0            [11]  984 	RET	NZ
   0504 FD 7E 00      [19]  985 	LD	A,0(IY)
   0507 FD 46 01      [19]  986 	LD	B,1(IY)
   050A B0            [ 4]  987 	OR	B
   050B C8            [11]  988 	RET	Z
   050C E5            [11]  989 	PUSH	HL
   050D                     990 	PCAJP4:
   050D DD 6E 00      [19]  991 	LD	L,0(IX)
   0510 DD 66 01      [19]  992 	LD	H,1(IX)
   0513 7E            [ 7]  993 	LD	A,(HL)
   0514 CB 7F         [ 8]  994 	BIT	7,A ;LOOP / EL RESTO DE BITS NO AFECTAN
   0516 28 09         [12]  995 	JR	Z,PCAJP0
   0518 E6 1F         [ 7]  996 	AND	#0b00011111 ;MÁXIMO LOOP PAUTA [0,32]X2!!!-> PARA ORNAMENTOS
   051A 07            [ 4]  997 	RLCA	;X2
   051B 16 00         [ 7]  998 	LD	D,#0
   051D 5F            [ 4]  999 	LD	E,A
   051E ED 52         [15] 1000 	SBC	HL,DE
   0520 7E            [ 7] 1001 	LD	A,(HL)
   0521                    1002 	PCAJP0:
   0521 CB 77         [ 8] 1003 	BIT	6,A ;OCTAVA -1
   0523 28 13         [12] 1004 	JR	Z,PCAJP1
   0525 FD 5E 00      [19] 1005 	LD	E,0(IY)
   0528 FD 56 01      [19] 1006 	LD	D,1(IY)
   052B A7            [ 4] 1007 	AND	A
   052C CB 0A         [ 8] 1008 	RRC	D
   052E CB 1B         [ 8] 1009 	RR	E
   0530 FD 73 00      [19] 1010 	LD	0(IY),E
   0533 FD 72 01      [19] 1011 	LD	1(IY),D
   0536 18 15         [12] 1012 	JR	PCAJP2
   0538                    1013 	PCAJP1:
   0538 CB 6F         [ 8] 1014 	BIT	5,A ;OCTAVA +1
   053A 28 11         [12] 1015 	JR	Z,PCAJP2
   053C FD 5E 00      [19] 1016 	LD	E,0(IY)
   053F FD 56 01      [19] 1017 	LD	D,1(IY)
   0542 A7            [ 4] 1018 	AND	A
   0543 CB 03         [ 8] 1019 	RLC	E
   0545 CB 12         [ 8] 1020 	RL	D
   0547 FD 73 00      [19] 1021 	LD	0(IY),E
   054A FD 72 01      [19] 1022 	LD	1(IY),D
   054D                    1023 	PCAJP2:
   054D 7E            [ 7] 1024 	LD	A,(HL)
   054E CB 67         [ 8] 1025 	BIT	4,A
   0550 20 2D         [12] 1026 	JR	NZ,PCAJP6 ;ORNAMENTOS SELECCIONADOS
                           1027 ;FUNCION	PITCH DE FRECUENCIA
   0552 23            [ 6] 1028 	INC	HL
   0553 E5            [11] 1029 	PUSH	HL
   0554 5F            [ 4] 1030 	LD	E,A
   0555 7E            [ 7] 1031 	LD	A,(HL) ;PITCH DE FRECUENCIA
   0556 6F            [ 4] 1032 	LD	L,A
   0557 A7            [ 4] 1033 	AND	A
   0558 7B            [ 4] 1034 	LD	A,E
   0559 28 30         [12] 1035 	JR	Z,ORNMJP1
   055B FD 7E 00      [19] 1036 	LD	A,0(IY) ;SI LA FRECUENCIA ES 0 NO HAY PITCH
   055E FD 86 01      [19] 1037 	ADD	A,1(IY)
   0561 A7            [ 4] 1038 	AND	A
   0562 7B            [ 4] 1039 	LD	A,E
   0563 28 26         [12] 1040 	JR	Z,ORNMJP1
   0565 CB 7D         [ 8] 1041 	BIT	7,L
   0567 28 04         [12] 1042 	JR	Z,ORNNEG
   0569 26 FF         [ 7] 1043 	LD	H,#0xFF
   056B 18 02         [12] 1044 	JR	PCAJP3
   056D                    1045 	ORNNEG:
   056D 26 00         [ 7] 1046 	LD	H,#0
   056F                    1047 	PCAJP3:
   056F FD 5E 00      [19] 1048 	LD	E,0(IY)
   0572 FD 56 01      [19] 1049 	LD	D,1(IY)
   0575 ED 5A         [15] 1050 	ADC	HL,DE
   0577 FD 75 00      [19] 1051 	LD	0(IY),L
   057A FD 74 01      [19] 1052 	LD	1(IY),H
   057D 18 0C         [12] 1053 	JR	ORNMJP1
                           1054 ;FUNCION	ORNAMENTOS
   057F                    1055 	PCAJP6:
   057F 23            [ 6] 1056 	INC	HL
   0580 E5            [11] 1057 	PUSH	HL
   0581 F5            [11] 1058 	PUSH	AF
   0582 DD 7E 18      [19] 1059 	LD	A,_REG_NOTA_A - _PUNTERO_P_A(IX) ;RECUPERA REGISTRO DE NOTA EN EL CANAL
   0585 5E            [ 7] 1060 	LD	E,(HL) ;
   0586 8B            [ 4] 1061 	ADC	E ;+- NOTA
   0587 CDrA9r05      [17] 1062 	CALL	TABLA_NOTAS
   058A F1            [10] 1063 	POP	AF
   058B                    1064 	ORNMJP1:
   058B E1            [10] 1065 	POP	HL
   058C 23            [ 6] 1066 	INC	HL
   058D DD 75 00      [19] 1067 	LD	0(IX),L
   0590 DD 74 01      [19] 1068 	LD	1(IX),H
   0593                    1069 	PCAJP5:
   0593 E1            [10] 1070 	POP	HL
   0594 DD 46 19      [19] 1071 	LD	B,_VOL_INST_A - _PUNTERO_P_A(IX) ;VOLUMEN RELATIVO
   0597 80            [ 4] 1072 	ADD	B
   0598 F2r9Dr05      [10] 1073 	JP	P,PCAJP7
   059B 3E 01         [ 7] 1074 	LD	A,#1 ;NO SE EXTIGUE EL VOLUMEN
   059D                    1075 	PCAJP7:
   059D E6 0F         [ 7] 1076 	AND	#0b00001111 ;VOLUMEN FINAL MODULADO
   059F 77            [ 7] 1077 	LD	(HL),A
   05A0 C9            [10] 1078 	RET
                           1079 ;NOTA	: REPRODUCE UNA NOTA
                           1080 ;IN	[A]=CODIGO DE LA NOTA
                           1081 ;	[IY]=REGISTROS DE FRECUENCIA
   05A1                    1082 	NOTA:
   05A1 69            [ 4] 1083 	LD	L,C
   05A2 60            [ 4] 1084 	LD	H,B
   05A3 CB 66         [12] 1085 	BIT	4,(HL)
   05A5 47            [ 4] 1086 	LD	B,A
   05A6 20 0E         [12] 1087 	JR	NZ,EVOLVENTES
   05A8 78            [ 4] 1088 	LD	A,B
   05A9                    1089 	TABLA_NOTAS:
   05A9 2ArB1r00      [16] 1090 	LD	HL,(#_DATOS_NOTAS) ;BUSCA FRECUENCIA
   05AC CDr01r06      [17] 1091 	CALL	EXT_WORD
   05AF FD 75 00      [19] 1092 	LD	0(IY),L
   05B2 FD 74 01      [19] 1093 	LD	1(IY),H
   05B5 C9            [10] 1094 	RET
                           1095 ;IN	[A]=CODIGO DE LA ENVOLVENTE
                           1096 ;	[IY]=REGISTRO DE FRECUENCIA
   05B6                    1097 	EVOLVENTES:
   05B6 2ArB1r00      [16] 1098 	LD	HL,(#_DATOS_NOTAS)
                           1099 ;SUB	12
   05B9 07            [ 4] 1100 	RLCA	;X2
   05BA 16 00         [ 7] 1101 	LD	D,#0
   05BC 5F            [ 4] 1102 	LD	E,A
   05BD 19            [11] 1103 	ADD	HL,DE
   05BE 5E            [ 7] 1104 	LD	E,(HL)
   05BF 23            [ 6] 1105 	INC	HL
   05C0 56            [ 7] 1106 	LD	D,(HL)
   05C1 D5            [11] 1107 	PUSH	DE
   05C2 3Ar69r00      [13] 1108 	LD	A,(#_ENVOLVENTE) ;FRECUENCIA DEL CANAL ON/OFF
   05C5 1F            [ 4] 1109 	RRA
   05C6 30 08         [12] 1110 	JR	NC,FRECUENCIA_OFF
   05C8 FD 73 00      [19] 1111 	LD	0(IY),E
   05CB FD 72 01      [19] 1112 	LD	1(IY),D
   05CE 18 09         [12] 1113 	JR	CONT_ENV
   05D0                    1114 	FRECUENCIA_OFF:
   05D0 11 00 00      [10] 1115 	LD	DE,#0
   05D3 FD 73 00      [19] 1116 	LD	0(IY),E
   05D6 FD 72 01      [19] 1117 	LD	1(IY),D
                           1118 ;CALCULO	DEL RATIO (OCTAVA ARRIBA)
   05D9                    1119 	CONT_ENV:
   05D9 D1            [10] 1120 	POP	DE
   05DA F5            [11] 1121 	PUSH	AF
   05DB C5            [11] 1122 	PUSH	BC
   05DC E6 03         [ 7] 1123 	AND	#0b00000011
   05DE 47            [ 4] 1124 	LD	B,A
                           1125 ;INC	B
                           1126 ;AND	A ;1/2
   05DF CB 1A         [ 8] 1127 	RR	D
   05E1 CB 1B         [ 8] 1128 	RR	E
   05E3                    1129 	CRTBC0:
                           1130 ;AND	A ;1/4 - 1/8 - 1/16
   05E3 CB 1A         [ 8] 1131 	RR	D
   05E5 CB 1B         [ 8] 1132 	RR	E
   05E7 10 FA         [13] 1133 	DJNZ	CRTBC0
   05E9 7B            [ 4] 1134 	LD	A,E
   05EA 32r54r00      [13] 1135 	LD	(#_PSG_REG+11),A
   05ED 7A            [ 4] 1136 	LD	A,D
   05EE E6 03         [ 7] 1137 	AND	#0b00000011
   05F0 32r55r00      [13] 1138 	LD	(#_PSG_REG+11 +1),A
   05F3 C1            [10] 1139 	POP	BC
   05F4 F1            [10] 1140 	POP	AF ;SELECCION FORMA DE ENVOLVENTE
   05F5 1F            [ 4] 1141 	RRA
   05F6 E6 06         [ 7] 1142 	AND	#0b00000110 ;$08,$0A,$0C,$0E
   05F8 C6 08         [ 7] 1143 	ADD	#8
   05FA 32r56r00      [13] 1144 	LD	(#_PSG_REG+13),A
   05FD 32r6Ar00      [13] 1145 	LD	(#_ENVOLVENTE_BACK),A
   0600 C9            [10] 1146 	RET
                           1147 ;EXTRAE	UN WORD DE UNA TABLA
                           1148 ;IN:(HL)=DIRECCION	TABLA
                           1149 ;	[A]= POSICION
                           1150 ;OUT(HL)=WORD
   0601                    1151 	EXT_WORD:
   0601 16 00         [ 7] 1152 	LD	D,#0
   0603 07            [ 4] 1153 	RLCA
   0604 5F            [ 4] 1154 	LD	E,A
   0605 19            [11] 1155 	ADD	HL,DE
   0606 5E            [ 7] 1156 	LD	E,(HL)
   0607 23            [ 6] 1157 	INC	HL
   0608 56            [ 7] 1158 	LD	D,(HL)
   0609 EB            [ 4] 1159 	EX	DE,HL
   060A C9            [10] 1160 	RET
                           1161 ;src\WYZplayer.c:1442: }
                           1162 	.area _CODE
                           1163 	.area _INITIALIZER
                           1164 	.area _CABS (ABS)
