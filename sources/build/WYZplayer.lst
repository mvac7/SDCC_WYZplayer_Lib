                              1 ;--------------------------------------------------------
                              2 ; File Created by SDCC : free open source ANSI-C Compiler
                              3 ; Version 3.9.0 #11195 (MINGW64)
                              4 ;--------------------------------------------------------
                              5 	.module WYZplayer
                              6 	.optsdcc -mz80
                              7 	
                              8 ;--------------------------------------------------------
                              9 ; Public variables in this module
                             10 ;--------------------------------------------------------
                             11 	.globl _TABLA_DATOS_CANAL_SFX
                             12 	.globl _SELECT_CANAL_C
                             13 	.globl _SELECT_CANAL_B
                             14 	.globl _SELECT_CANAL_A
                             15 	.globl _DATOS_NOTAS
                             16 	.globl _TABLA_SONIDOS
                             17 	.globl _TABLA_PAUTAS
                             18 	.globl _TABLA_SONG
                             19 	.globl _SOUND_BUFFER_P
                             20 	.globl _SOUND_BUFFER_C
                             21 	.globl _SOUND_BUFFER_B
                             22 	.globl _SOUND_BUFFER_A
                             23 	.globl _ENVOLVENTE_BACK
                             24 	.globl _ENVOLVENTE
                             25 	.globl _AYREGS
                             26 	.globl _PSG_REG
                             27 	.globl _PUNTERO_SONIDO
                             28 	.globl _N_SONIDO
                             29 	.globl _SFX_MIX
                             30 	.globl _SFX_V
                             31 	.globl _SFX_H
                             32 	.globl _SFX_L
                             33 	.globl _PUNTERO_L_DECP
                             34 	.globl _PUNTERO_DECP
                             35 	.globl _PUNTERO_P_DECP
                             36 	.globl _CANAL_P
                             37 	.globl _PUNTERO_P
                             38 	.globl _PUNTERO_L_DECC
                             39 	.globl _PUNTERO_L_DECB
                             40 	.globl _PUNTERO_L_DECA
                             41 	.globl _VOL_INST_C
                             42 	.globl _REG_NOTA_C
                             43 	.globl _VOL_INST_B
                             44 	.globl _REG_NOTA_B
                             45 	.globl _VOL_INST_A
                             46 	.globl _REG_NOTA_A
                             47 	.globl _PUNTERO_DECC
                             48 	.globl _PUNTERO_DECB
                             49 	.globl _PUNTERO_DECA
                             50 	.globl _PUNTERO_P_DECC
                             51 	.globl _PUNTERO_P_DECB
                             52 	.globl _PUNTERO_P_DECA
                             53 	.globl _PUNTERO_P_C0
                             54 	.globl _PUNTERO_P_B0
                             55 	.globl _PUNTERO_P_A0
                             56 	.globl _PUNTERO_P_C
                             57 	.globl _PUNTERO_P_B
                             58 	.globl _PUNTERO_P_A
                             59 	.globl _CANAL_C
                             60 	.globl _CANAL_B
                             61 	.globl _CANAL_A
                             62 	.globl _PUNTERO_C
                             63 	.globl _PUNTERO_B
                             64 	.globl _PUNTERO_A
                             65 	.globl _TTEMPO
                             66 	.globl _TEMPO
                             67 	.globl _SONG
                             68 	.globl _WYZstate
                             69 	.globl _WYZ_Init
                             70 	.globl _WYZ_Pause
                             71 	.globl _WYZ_Resume
                             72 	.globl _WYZ_Loop
                             73 	.globl _WYZ_PlayFX
                             74 	.globl _WYZ_PlayAY
                             75 	.globl _WYZ_InitSong
                             76 	.globl _WYZ_Decode
                             77 ;--------------------------------------------------------
                             78 ; special function registers
                             79 ;--------------------------------------------------------
                             80 ;--------------------------------------------------------
                             81 ; ram data
                             82 ;--------------------------------------------------------
                             83 	.area _DATA
   0000                      84 _WYZstate::
   0000                      85 	.ds 1
   0001                      86 _SONG::
   0001                      87 	.ds 1
   0002                      88 _TEMPO::
   0002                      89 	.ds 1
   0003                      90 _TTEMPO::
   0003                      91 	.ds 1
   0004                      92 _PUNTERO_A::
   0004                      93 	.ds 2
   0006                      94 _PUNTERO_B::
   0006                      95 	.ds 2
   0008                      96 _PUNTERO_C::
   0008                      97 	.ds 2
   000A                      98 _CANAL_A::
   000A                      99 	.ds 2
   000C                     100 _CANAL_B::
   000C                     101 	.ds 2
   000E                     102 _CANAL_C::
   000E                     103 	.ds 2
   0010                     104 _PUNTERO_P_A::
   0010                     105 	.ds 2
   0012                     106 _PUNTERO_P_B::
   0012                     107 	.ds 2
   0014                     108 _PUNTERO_P_C::
   0014                     109 	.ds 2
   0016                     110 _PUNTERO_P_A0::
   0016                     111 	.ds 2
   0018                     112 _PUNTERO_P_B0::
   0018                     113 	.ds 2
   001A                     114 _PUNTERO_P_C0::
   001A                     115 	.ds 2
   001C                     116 _PUNTERO_P_DECA::
   001C                     117 	.ds 2
   001E                     118 _PUNTERO_P_DECB::
   001E                     119 	.ds 2
   0020                     120 _PUNTERO_P_DECC::
   0020                     121 	.ds 2
   0022                     122 _PUNTERO_DECA::
   0022                     123 	.ds 2
   0024                     124 _PUNTERO_DECB::
   0024                     125 	.ds 2
   0026                     126 _PUNTERO_DECC::
   0026                     127 	.ds 2
   0028                     128 _REG_NOTA_A::
   0028                     129 	.ds 1
   0029                     130 _VOL_INST_A::
   0029                     131 	.ds 1
   002A                     132 _REG_NOTA_B::
   002A                     133 	.ds 1
   002B                     134 _VOL_INST_B::
   002B                     135 	.ds 1
   002C                     136 _REG_NOTA_C::
   002C                     137 	.ds 1
   002D                     138 _VOL_INST_C::
   002D                     139 	.ds 1
   002E                     140 _PUNTERO_L_DECA::
   002E                     141 	.ds 2
   0030                     142 _PUNTERO_L_DECB::
   0030                     143 	.ds 2
   0032                     144 _PUNTERO_L_DECC::
   0032                     145 	.ds 2
   0034                     146 _PUNTERO_P::
   0034                     147 	.ds 2
   0036                     148 _CANAL_P::
   0036                     149 	.ds 2
   0038                     150 _PUNTERO_P_DECP::
   0038                     151 	.ds 2
   003A                     152 _PUNTERO_DECP::
   003A                     153 	.ds 2
   003C                     154 _PUNTERO_L_DECP::
   003C                     155 	.ds 2
   003E                     156 _SFX_L::
   003E                     157 	.ds 2
   0040                     158 _SFX_H::
   0040                     159 	.ds 2
   0042                     160 _SFX_V::
   0042                     161 	.ds 2
   0044                     162 _SFX_MIX::
   0044                     163 	.ds 2
   0046                     164 _N_SONIDO::
   0046                     165 	.ds 1
   0047                     166 _PUNTERO_SONIDO::
   0047                     167 	.ds 2
   0049                     168 _PSG_REG::
   0049                     169 	.ds 16
   0059                     170 _AYREGS::
   0059                     171 	.ds 16
   0069                     172 _ENVOLVENTE::
   0069                     173 	.ds 1
   006A                     174 _ENVOLVENTE_BACK::
   006A                     175 	.ds 1
   006B                     176 _SOUND_BUFFER_A::
   006B                     177 	.ds 16
   007B                     178 _SOUND_BUFFER_B::
   007B                     179 	.ds 16
   008B                     180 _SOUND_BUFFER_C::
   008B                     181 	.ds 16
   009B                     182 _SOUND_BUFFER_P::
   009B                     183 	.ds 16
   00AB                     184 _TABLA_SONG::
   00AB                     185 	.ds 2
   00AD                     186 _TABLA_PAUTAS::
   00AD                     187 	.ds 2
   00AF                     188 _TABLA_SONIDOS::
   00AF                     189 	.ds 2
   00B1                     190 _DATOS_NOTAS::
   00B1                     191 	.ds 2
   00B3                     192 _SELECT_CANAL_A::
   00B3                     193 	.ds 7
   00BA                     194 _SELECT_CANAL_B::
   00BA                     195 	.ds 7
   00C1                     196 _SELECT_CANAL_C::
   00C1                     197 	.ds 7
   00C8                     198 _TABLA_DATOS_CANAL_SFX::
   00C8                     199 	.ds 6
                            200 ;--------------------------------------------------------
                            201 ; ram data
                            202 ;--------------------------------------------------------
                            203 	.area _INITIALIZED
                            204 ;--------------------------------------------------------
                            205 ; absolute external ram data
                            206 ;--------------------------------------------------------
                            207 	.area _DABS (ABS)
                            208 ;--------------------------------------------------------
                            209 ; global & static initialisations
                            210 ;--------------------------------------------------------
                            211 	.area _HOME
                            212 	.area _GSINIT
                            213 	.area _GSFINAL
                            214 	.area _GSINIT
                            215 ;--------------------------------------------------------
                            216 ; Home
                            217 ;--------------------------------------------------------
                            218 	.area _HOME
                            219 	.area _HOME
                            220 ;--------------------------------------------------------
                            221 ; code
                            222 ;--------------------------------------------------------
                            223 	.area _CODE
                            224 ;src\WYZplayer.c:189: void WYZ_Init(unsigned int addrSONGs, unsigned int addrInstruments, unsigned int addrFXs, unsigned int addrFreqs) __naked
                            225 ;	---------------------------------
                            226 ; Function WYZ_Init
                            227 ; ---------------------------------
   0000                     228 _WYZ_Init::
                            229 ;src\WYZplayer.c:288: __endasm;
   0000 DD E5         [15]  230 	push	IX
   0002 DD 21 00 00   [14]  231 	ld	IX,#0
   0006 DD 39         [15]  232 	add	IX,SP
   0008 DD 6E 04      [19]  233 	ld	L,4(IX)
   000B DD 66 05      [19]  234 	ld	H,5(IX)
   000E 22rABr00      [16]  235 	ld	(#_TABLA_SONG),HL
   0011 DD 6E 06      [19]  236 	ld	L,6(IX)
   0014 DD 66 07      [19]  237 	ld	H,7(IX)
   0017 22rADr00      [16]  238 	ld	(#_TABLA_PAUTAS),HL
   001A DD 6E 08      [19]  239 	ld	L,8(IX)
   001D DD 66 09      [19]  240 	ld	H,9(IX)
   0020 22rAFr00      [16]  241 	ld	(#_TABLA_SONIDOS),HL
   0023 DD 6E 0A      [19]  242 	ld	L,10(IX)
   0026 DD 66 0B      [19]  243 	ld	H,11(IX)
   0029 22rB1r00      [16]  244 	ld	(#_DATOS_NOTAS),HL
   002C AF            [ 4]  245 	XOR	A
   002D 32r00r00      [13]  246 	LD	(#_WYZstate),A
   0030 CDrAAr00      [17]  247 	call	CLEAR_PSG_BUFFER ;PLAYER_OFF
   0033 21r6Br00      [10]  248 	LD	HL,#_SOUND_BUFFER_A ;* RESERVAR MEMORIA PARA BUFFER DE SONIDO!!!!!
   0036 22r0Ar00      [16]  249 	LD	(#_CANAL_A),HL
   0039 21r7Br00      [10]  250 	LD	HL,#_SOUND_BUFFER_B
   003C 22r0Cr00      [16]  251 	LD	(#_CANAL_B),HL
   003F 21r8Br00      [10]  252 	LD	HL,#_SOUND_BUFFER_C
   0042 22r0Er00      [16]  253 	LD	(#_CANAL_C),HL
   0045 21r9Br00      [10]  254 	LD	HL,#_SOUND_BUFFER_P
   0048 22r36r00      [16]  255 	LD	(#_CANAL_P),HL
                            256 ;TABLA	DE DATOS DEL SELECTOR DEL CANAL DE EFECTOS DE RITMO
                            257 ;---	chan A
   004B 21r59r00      [10]  258 	LD	HL,#_AYREGS+0
   004E 22rB3r00      [16]  259 	LD	(#_SELECT_CANAL_A),HL
   0051 21r5Ar00      [10]  260 	LD	HL,#_AYREGS+0 +1
   0054 22rB5r00      [16]  261 	LD	(#_SELECT_CANAL_A+2),HL
   0057 21r61r00      [10]  262 	LD	HL,#_AYREGS+8
   005A 22rB7r00      [16]  263 	LD	(#_SELECT_CANAL_A+4),HL
   005D 3E B1         [ 7]  264 	LD	A,#0b10110001
   005F 32rB9r00      [13]  265 	LD	(#_SELECT_CANAL_A+6),A
                            266 ;---	chan B
   0062 21r5Br00      [10]  267 	LD	HL,#_AYREGS+2
   0065 22rBAr00      [16]  268 	LD	(#_SELECT_CANAL_B),HL
   0068 21r5Cr00      [10]  269 	LD	HL,#_AYREGS+2 +1
   006B 22rBCr00      [16]  270 	LD	(#_SELECT_CANAL_B+2),HL
   006E 21r62r00      [10]  271 	LD	HL,#_AYREGS+9
   0071 22rBEr00      [16]  272 	LD	(#_SELECT_CANAL_B+4),HL
   0074 3E AA         [ 7]  273 	LD	A,#0b10101010
   0076 32rC0r00      [13]  274 	LD	(#_SELECT_CANAL_B+6),A
                            275 ;---	chan C
   0079 21r5Dr00      [10]  276 	LD	HL,#_AYREGS+4
   007C 22rC1r00      [16]  277 	LD	(#_SELECT_CANAL_C),HL
   007F 21r5Er00      [10]  278 	LD	HL,#_AYREGS+4 +1
   0082 22rC3r00      [16]  279 	LD	(#_SELECT_CANAL_C+2),HL
   0085 21r63r00      [10]  280 	LD	HL,#_AYREGS+10
   0088 22rC5r00      [16]  281 	LD	(#_SELECT_CANAL_C+4),HL
   008B 3E 9C         [ 7]  282 	LD	A,#0b10011100
   008D 32rC7r00      [13]  283 	LD	(#_SELECT_CANAL_C+6),A
                            284 ;	TABLA_DATOS_CANAL_SFX
   0090 21rB3r00      [10]  285 	LD	HL,#_SELECT_CANAL_A
   0093 22rC8r00      [16]  286 	LD	(#_TABLA_DATOS_CANAL_SFX),HL
   0096 21rBAr00      [10]  287 	LD	HL,#_SELECT_CANAL_B
   0099 22rCAr00      [16]  288 	LD	(#_TABLA_DATOS_CANAL_SFX+2),HL
   009C 21rC1r00      [10]  289 	LD	HL,#_SELECT_CANAL_C
   009F 22rCCr00      [16]  290 	LD	(#_TABLA_DATOS_CANAL_SFX+4),HL
   00A2 DD E1         [14]  291 	pop	IX
   00A4 C9            [10]  292 	ret
                            293 ;src\WYZplayer.c:289: }         
                            294 ;src\WYZplayer.c:302: void WYZ_Pause()
                            295 ;	---------------------------------
                            296 ; Function WYZ_Pause
                            297 ; ---------------------------------
   00A5                     298 _WYZ_Pause::
                            299 ;src\WYZplayer.c:332: __endasm;
   00A5                     300 	PLAYER_OFF:
                            301 ;	XOR A
                            302 ;	LD [INTERR],A
                            303 ;	LD [FADE],A ;solo si hay fade out
   00A5 21r00r00      [10]  304 	LD	HL,#_WYZstate
   00A8 CB 8E         [15]  305 	RES	1,(HL)
   00AA                     306 	CLEAR_PSG_BUFFER:
   00AA AF            [ 4]  307 	XOR	A
   00AB 21r49r00      [10]  308 	LD	HL,#_PSG_REG
   00AE 11r4Ar00      [10]  309 	LD	DE,#_PSG_REG+1
   00B1 01 0E 00      [10]  310 	LD	BC,#14
   00B4 77            [ 7]  311 	LD	(HL),A
   00B5 ED B0         [21]  312 	LDIR
   00B7 3E B8         [ 7]  313 	LD	A,#0b10111000 ; **** POR SI ACASO ****
   00B9 32r50r00      [13]  314 	LD	(#_PSG_REG+7),A
   00BC 21r49r00      [10]  315 	LD	HL,#_PSG_REG
   00BF 11r59r00      [10]  316 	LD	DE,#_AYREGS
   00C2 01 0E 00      [10]  317 	LD	BC,#14
   00C5 ED B0         [21]  318 	LDIR
   00C7 CDr0Fr01      [17]  319 	CALL	ROUT
   00CA C9            [10]  320 	RET
                            321 ;src\WYZplayer.c:333: }
   00CB C9            [10]  322 	ret
                            323 ;src\WYZplayer.c:347: void WYZ_Resume() __naked
                            324 ;	---------------------------------
                            325 ; Function WYZ_Resume
                            326 ; ---------------------------------
   00CC                     327 _WYZ_Resume::
                            328 ;src\WYZplayer.c:354: __endasm;
   00CC 21r00r00      [10]  329 	LD	HL,#_WYZstate
   00CF CB CE         [15]  330 	SET	1,(HL) ;PLAYER ON
   00D1 C9            [10]  331 	RET
                            332 ;src\WYZplayer.c:355: }
                            333 ;src\WYZplayer.c:368: void WYZ_Loop(char loop) __naked
                            334 ;	---------------------------------
                            335 ; Function WYZ_Loop
                            336 ; ---------------------------------
   00D2                     337 _WYZ_Loop::
                            338 ;src\WYZplayer.c:396: __endasm;
   00D2 DD E5         [15]  339 	push	IX
   00D4 DD 21 00 00   [14]  340 	ld	IX,#0
   00D8 DD 39         [15]  341 	add	IX,SP
   00DA DD 7E 04      [19]  342 	ld	A,4(IX)
   00DD CDrE3r00      [17]  343 	call	setLoop
   00E0 DD E1         [14]  344 	pop	IX
   00E2 C9            [10]  345 	RET
   00E3                     346 	setLoop:
   00E3 21r00r00      [10]  347 	LD	HL,#_WYZstate
   00E6 B7            [ 4]  348 	or	A
   00E7 28 03         [12]  349 	jr	Z,resetLOOP
   00E9 CB E6         [15]  350 	SET	4,(HL) ;LOOP ON
   00EB C9            [10]  351 	ret
   00EC                     352 	resetLOOP:
   00EC CB A6         [15]  353 	RES	4,(HL)
   00EE C9            [10]  354 	ret
                            355 ;src\WYZplayer.c:397: }
                            356 ;src\WYZplayer.c:410: void WYZ_PlayFX(char numSound) __naked
                            357 ;	---------------------------------
                            358 ; Function WYZ_PlayFX
                            359 ; ---------------------------------
   00EF                     360 _WYZ_PlayFX::
                            361 ;src\WYZplayer.c:440: __endasm;
   00EF DD E5         [15]  362 	push	IX
   00F1 DD 21 00 00   [14]  363 	ld	IX,#0
   00F5 DD 39         [15]  364 	add	IX,sp
   00F7 DD 7E 04      [19]  365 	LD	A,4(IX)
   00FA CDr00r01      [17]  366 	CALL	INICIA_SONIDO
   00FD DD E1         [14]  367 	pop	IX
   00FF C9            [10]  368 	ret
                            369 ;INICIA	EL SONIDO No [A]
   0100                     370 	INICIA_SONIDO:
                            371 ;CP	8 ;SFX SPEECH
                            372 ;JP	Z,SLOOP
   0100 2ArAFr00      [16]  373 	LD	HL,(#_TABLA_SONIDOS) ;(v SDCC) HL,TABLA_SONIDOS
   0103 CDrFFr05      [17]  374 	CALL	EXT_WORD
   0106 22r47r00      [16]  375 	LD	(#_PUNTERO_SONIDO),HL
   0109 21r00r00      [10]  376 	LD	HL,#_WYZstate
   010C CB D6         [15]  377 	SET	2,(HL)
   010E C9            [10]  378 	RET
                            379 ;src\WYZplayer.c:441: } 
                            380 ;src\WYZplayer.c:458: void WYZ_PlayAY() __naked
                            381 ;	---------------------------------
                            382 ; Function WYZ_PlayAY
                            383 ; ---------------------------------
   010F                     384 _WYZ_PlayAY::
                            385 ;src\WYZplayer.c:511: __endasm;
   010F                     386 	ROUT:
                            387 ;Record	register 7 of the AY38910 ----------------------------------------------
                            388 ;collects	the last two bits for joysctick port control
                            389 ;and	adds them to the value of the mixer bits
   010F 3Ar60r00      [13]  390 	ld	A,(#_AYREGS+7)
   0112 E6 3F         [ 7]  391 	and	#0b00111111
   0114 47            [ 4]  392 	ld	B,A
   0115 3E 07         [ 7]  393 	ld	A,#7
   0117 D3 A0         [11]  394 	out	(#0xA0),A
   0119 DB A2         [11]  395 	in	A,(#0xA2)
   011B E6 C0         [ 7]  396 	and	#0b11000000 ; Mask to catch only the two bits of joys
   011D B0            [ 4]  397 	or	B ; Add B
   011E 32r60r00      [13]  398 	ld	(#_AYREGS+7),A
                            399 ;END	register 7 ----------------------------------------------------------------
   0121 3Ar56r00      [13]  400 	LD	A,(#_PSG_REG+13)
   0124 A7            [ 4]  401 	AND	A ;ES CERO?
   0125 28 03         [12]  402 	JR	Z,NO_BACKUP_ENVOLVENTE
   0127 32r6Ar00      [13]  403 	LD	(#_ENVOLVENTE_BACK),A ;08.13 / GUARDA LA ENVOLVENTE EN EL BACKUP
   012A                     404 	NO_BACKUP_ENVOLVENTE:
   012A AF            [ 4]  405 	XOR	A
   012B 0E A0         [ 7]  406 	LD	C,#0xA0 ;0xA0
   012D 21r59r00      [10]  407 	LD	HL,#_AYREGS
   0130                     408 	LOUT:
   0130 ED 79         [12]  409 	OUT	(C),A
   0132 0C            [ 4]  410 	INC	C
   0133 ED A3         [16]  411 	OUTI
   0135 0D            [ 4]  412 	DEC	C
   0136 3C            [ 4]  413 	INC	A
   0137 FE 0D         [ 7]  414 	CP	#13
   0139 20 F5         [12]  415 	JR	NZ,LOUT
   013B ED 79         [12]  416 	OUT	(C),A
   013D 7E            [ 7]  417 	LD	A,(HL)
   013E A7            [ 4]  418 	AND	A
   013F C8            [11]  419 	RET	Z
   0140 0C            [ 4]  420 	INC	C
   0141 ED 79         [12]  421 	OUT	(C),A
   0143 AF            [ 4]  422 	XOR	A
   0144 32r66r00      [13]  423 	LD	(#_AYREGS+13),A
   0147 32r56r00      [13]  424 	LD	(#_PSG_REG+13),A
   014A C9            [10]  425 	RET
                            426 ;src\WYZplayer.c:512: }
                            427 ;src\WYZplayer.c:529: void WYZ_InitSong(char numSong, char loop) __naked
                            428 ;	---------------------------------
                            429 ; Function WYZ_InitSong
                            430 ; ---------------------------------
   014B                     431 _WYZ_InitSong::
                            432 ;src\WYZplayer.c:724: __endasm;
   014B DD E5         [15]  433 	push	IX
   014D DD 21 00 00   [14]  434 	ld	IX,#0
   0151 DD 39         [15]  435 	add	IX,sp
   0153 DD 7E 05      [19]  436 	ld	A,5(IX)
   0156 CDrE3r00      [17]  437 	call	setLoop
   0159 DD 7E 04      [19]  438 	LD	A,4(IX)
   015C CDr62r01      [17]  439 	call	CARGA_CANCION
   015F DD E1         [14]  440 	pop	IX
   0161 C9            [10]  441 	ret
                            442 ;CARGA	UNA CANCION
                            443 ;IN:[A]=Nº	DE CANCION
   0162                     444 	CARGA_CANCION:
                            445 ;LD	HL,#_SONG
   0162 32r01r00      [13]  446 	LD	(#_SONG),A ;Nº A
   0165 21r00r00      [10]  447 	LD	HL,#_WYZstate ;CARGA CANCION
   0168 CB CE         [15]  448 	SET	1,(HL) ;REPRODUCE CANCION
                            449 ;DECODIFICAR
                            450 ;IN->	WYZstate 0 ON
                            451 ;	SONG
                            452 ;CARGA	CANCION SI/NO
   016A                     453 	DECODE_SONG:
   016A 3Ar01r00      [13]  454 	LD	A,(#_SONG)
                            455 ;LEE	CABECERA DE LA CANCION
                            456 ;BYTE	0=TEMPO
   016D 2ArABr00      [16]  457 	LD	HL,(#_TABLA_SONG) ;(v SDCC) HL,_TABLA_SONG
   0170 CDrFFr05      [17]  458 	CALL	EXT_WORD
   0173 7E            [ 7]  459 	LD	A,(HL)
   0174 32r02r00      [13]  460 	LD	(#_TEMPO),A
   0177 3D            [ 4]  461 	DEC	A
   0178 32r03r00      [13]  462 	LD	(#_TTEMPO),A
                            463 ;HEADER	BYTE 1
                            464 ;[-|-|-|-|	3-1 | 0 ]
                            465 ;[-|-|-|-|FX	CHN|LOOP]
   017B 23            [ 6]  466 	INC	HL ;LOOP 1=ON/0=OFF?
   017C 7E            [ 7]  467 	LD	A,(HL)
                            468 ;BIT	0,A
                            469 ;JR	Z,NPTJP0
                            470 ;PUSH	HL
                            471 ;LD	HL,#_WYZstate
                            472 ;SET	4,(HL)
                            473 ;POP	HL
                            474 ;SELECCION	DEL CANAL DE EFECTOS DE RITMO
   017D                     475 	NPTJP0:
   017D E6 06         [ 7]  476 	AND	#0b00000110
   017F 1F            [ 4]  477 	RRA
                            478 ;LD	(#_SELECT_CANAL_P),A
   0180 E5            [11]  479 	PUSH	HL
   0181 21rC8r00      [10]  480 	LD	HL,#_TABLA_DATOS_CANAL_SFX
   0184 CDrFFr05      [17]  481 	CALL	EXT_WORD
   0187 E5            [11]  482 	PUSH	HL
   0188 DD E1         [14]  483 	POP	IX
   018A DD 5E 00      [19]  484 	LD	E,0(IX)
   018D DD 56 01      [19]  485 	LD	D,1(IX)
   0190 ED 53r3Er00   [20]  486 	LD	(#_SFX_L),DE
   0194 DD 5E 02      [19]  487 	LD	E,2(IX)
   0197 DD 56 03      [19]  488 	LD	D,3(IX)
   019A ED 53r40r00   [20]  489 	LD	(#_SFX_H),DE
   019E DD 5E 04      [19]  490 	LD	E,4(IX)
   01A1 DD 56 05      [19]  491 	LD	D,5(IX)
   01A4 ED 53r42r00   [20]  492 	LD	(#_SFX_V),DE
   01A8 DD 7E 06      [19]  493 	LD	A,6(IX)
   01AB 32r44r00      [13]  494 	LD	(#_SFX_MIX),A
   01AE E1            [10]  495 	POP	HL
   01AF 23            [ 6]  496 	INC	HL ;2 BYTES RESERVADOS
   01B0 23            [ 6]  497 	INC	HL
   01B1 23            [ 6]  498 	INC	HL
                            499 ;BUSCA	Y GUARDA INICIO DE LOS CANALES EN EL MODULO MUS (OPTIMIZAR)
                            500 ;AÑADE	OFFSET DEL LOOP
   01B2 E5            [11]  501 	PUSH	HL ;IX INICIO OFFSETS LOOP POR CANAL
   01B3 DD E1         [14]  502 	POP	IX
   01B5 11 08 00      [10]  503 	LD	DE,#0x0008 ;HASTA INICIO DEL CANAL A
   01B8 19            [11]  504 	ADD	HL,DE
   01B9 22r1Cr00      [16]  505 	LD	(#_PUNTERO_P_DECA),HL ;GUARDA PUNTERO INICIO CANAL
   01BC DD 5E 00      [19]  506 	LD	E,(IX)
   01BF DD 56 01      [19]  507 	LD	D,1(IX)
   01C2 19            [11]  508 	ADD	HL,DE
   01C3 22r2Er00      [16]  509 	LD	(#_PUNTERO_L_DECA),HL ;GUARDA PUNTERO INICIO LOOP
   01C6 CDr3Br02      [17]  510 	CALL	BGICMODBC1
   01C9 22r1Er00      [16]  511 	LD	(#_PUNTERO_P_DECB),HL
   01CC DD 5E 02      [19]  512 	LD	E,2(IX)
   01CF DD 56 03      [19]  513 	LD	D,3(IX)
   01D2 19            [11]  514 	ADD	HL,DE
   01D3 22r30r00      [16]  515 	LD	(#_PUNTERO_L_DECB),HL
   01D6 CDr3Br02      [17]  516 	CALL	BGICMODBC1
   01D9 22r20r00      [16]  517 	LD	(#_PUNTERO_P_DECC),HL
   01DC DD 5E 04      [19]  518 	LD	E,4(IX)
   01DF DD 56 05      [19]  519 	LD	D,5(IX)
   01E2 19            [11]  520 	ADD	HL,DE
   01E3 22r32r00      [16]  521 	LD	(#_PUNTERO_L_DECC),HL
   01E6 CDr3Br02      [17]  522 	CALL	BGICMODBC1
   01E9 22r38r00      [16]  523 	LD	(#_PUNTERO_P_DECP),HL
   01EC DD 5E 06      [19]  524 	LD	E,6(IX)
   01EF DD 56 07      [19]  525 	LD	D,7(IX)
   01F2 19            [11]  526 	ADD	HL,DE
   01F3 22r3Cr00      [16]  527 	LD	(#_PUNTERO_L_DECP),HL
                            528 ;LEE	DATOS DE LAS NOTAS
                            529 ;[|][|||||]	LONGITUD\NOTA
   01F6                     530 	INIT_DECODER:
   01F6 ED 5Br0Ar00   [20]  531 	LD	DE,(#_CANAL_A)
   01FA ED 53r04r00   [20]  532 	LD	(#_PUNTERO_A),DE
   01FE 2Ar1Cr00      [16]  533 	LD	HL,(#_PUNTERO_P_DECA)
   0201 CDr4Ar03      [17]  534 	CALL	DECODE_CANAL ;CANAL A
   0204 22r22r00      [16]  535 	LD	(#_PUNTERO_DECA),HL
   0207 ED 5Br0Cr00   [20]  536 	LD	DE,(#_CANAL_B)
   020B ED 53r06r00   [20]  537 	LD	(#_PUNTERO_B),DE
   020F 2Ar1Er00      [16]  538 	LD	HL,(#_PUNTERO_P_DECB)
   0212 CDr4Ar03      [17]  539 	CALL	DECODE_CANAL ;CANAL B
   0215 22r24r00      [16]  540 	LD	(#_PUNTERO_DECB),HL
   0218 ED 5Br0Er00   [20]  541 	LD	DE,(#_CANAL_C)
   021C ED 53r08r00   [20]  542 	LD	(#_PUNTERO_C),DE
   0220 2Ar20r00      [16]  543 	LD	HL,(#_PUNTERO_P_DECC)
   0223 CDr4Ar03      [17]  544 	CALL	DECODE_CANAL ;CANAL C
   0226 22r26r00      [16]  545 	LD	(#_PUNTERO_DECC),HL
   0229 ED 5Br36r00   [20]  546 	LD	DE,(#_CANAL_P)
   022D ED 53r34r00   [20]  547 	LD	(#_PUNTERO_P),DE
   0231 2Ar38r00      [16]  548 	LD	HL,(#_PUNTERO_P_DECP)
   0234 CDr4Ar03      [17]  549 	CALL	DECODE_CANAL ;CANAL P (FX)
   0237 22r3Ar00      [16]  550 	LD	(#_PUNTERO_DECP),HL
   023A C9            [10]  551 	RET
                            552 ;BUSCA	INICIO DEL CANAL
   023B                     553 	BGICMODBC1:
   023B AF            [ 4]  554 	XOR	A ;BUSCA EL BYTE 0
   023C 1E 3F         [ 7]  555 	LD	E,#0x3F ;CODIGO INSTRUMENTO 0
   023E 06 FF         [ 7]  556 	LD	B,#0xFF ;EL MODULO DEBE TENER UNA LONGITUD MENOR DE $FF00 ... o_O!
   0240 ED B1         [21]  557 	CPIR
   0242 2B            [ 6]  558 	DEC	HL
   0243 2B            [ 6]  559 	DEC	HL
   0244 7B            [ 4]  560 	LD	A,E ;ES EL INSTRUMENTO 0??
   0245 BE            [ 7]  561 	CP	(HL)
   0246 23            [ 6]  562 	INC	HL
   0247 23            [ 6]  563 	INC	HL
   0248 28 F1         [12]  564 	JR	Z,BGICMODBC1
   024A 2B            [ 6]  565 	DEC	HL
   024B 2B            [ 6]  566 	DEC	HL
   024C 2B            [ 6]  567 	DEC	HL
   024D 7B            [ 4]  568 	LD	A,E ;ES VOLUMEN 0??
   024E BE            [ 7]  569 	CP	(HL)
   024F 23            [ 6]  570 	INC	HL
   0250 23            [ 6]  571 	INC	HL
   0251 23            [ 6]  572 	INC	HL
   0252 28 E7         [12]  573 	JR	Z,BGICMODBC1
   0254 C9            [10]  574 	RET
                            575 ;src\WYZplayer.c:725: }
                            576 ;src\WYZplayer.c:744: void WYZ_Decode() __naked
                            577 ;	---------------------------------
                            578 ; Function WYZ_Decode
                            579 ; ---------------------------------
   0255                     580 _WYZ_Decode::
                            581 ;src\WYZplayer.c:1437: __endasm;
   0255                     582 	INICIO:
                            583 ;	push IX
                            584 ;	CALL ROUT
                            585 ;	CALL MIXER
   0255 21r49r00      [10]  586 	LD	HL,#_PSG_REG
   0258 11r59r00      [10]  587 	LD	DE,#_AYREGS
   025B 01 0E 00      [10]  588 	LD	BC,#14
   025E ED B0         [21]  589 	LDIR
   0260 CDr67r02      [17]  590 	CALL	REPRODUCE_SONIDO
   0263 CDrDCr02      [17]  591 	CALL	PLAY
                            592 ;	pop IX
   0266 C9            [10]  593 	RET
                            594 ;REPRODUCE	EFECTOS DE SONIDO
   0267                     595 	REPRODUCE_SONIDO:
   0267 21r00r00      [10]  596 	LD	HL,#_WYZstate
   026A CB 56         [12]  597 	BIT	2,(HL) ;ESTA ACTIVADO EL EFECTO?
   026C C8            [11]  598 	RET	Z
   026D 2Ar47r00      [16]  599 	LD	HL,(#_PUNTERO_SONIDO)
   0270 7E            [ 7]  600 	LD	A,(HL)
   0271 FE FF         [ 7]  601 	CP	#0xFF
   0273 28 53         [12]  602 	JR	Z,FIN_SONIDO
   0275 ED 5Br3Er00   [20]  603 	LD	DE,(#_SFX_L)
   0279 12            [ 7]  604 	LD	(DE),A
   027A 23            [ 6]  605 	INC	HL
   027B 7E            [ 7]  606 	LD	A,(HL)
   027C 0F            [ 4]  607 	RRCA
   027D 0F            [ 4]  608 	RRCA
   027E 0F            [ 4]  609 	RRCA
   027F 0F            [ 4]  610 	RRCA
   0280 E6 0F         [ 7]  611 	AND	#0b00001111
   0282 ED 5Br40r00   [20]  612 	LD	DE,(#_SFX_H)
   0286 12            [ 7]  613 	LD	(DE),A
   0287 7E            [ 7]  614 	LD	A,(HL)
   0288 E6 0F         [ 7]  615 	AND	#0b00001111
   028A ED 5Br42r00   [20]  616 	LD	DE,(#_SFX_V)
   028E 12            [ 7]  617 	LD	(DE),A
   028F 23            [ 6]  618 	INC	HL
   0290 7E            [ 7]  619 	LD	A,(HL)
   0291 47            [ 4]  620 	LD	B,A
   0292 CB 7F         [ 8]  621 	BIT	7,A ;09.08.13 BIT MAS SIGINIFICATIVO ACTIVA ENVOLVENTES
   0294 28 16         [12]  622 	JR	Z,NO_ENVOLVENTES_SONIDO
   0296 3E 12         [ 7]  623 	LD	A,#0x12
   0298 12            [ 7]  624 	LD	(DE),A
   0299 23            [ 6]  625 	INC	HL
   029A 7E            [ 7]  626 	LD	A,(HL)
   029B 32r64r00      [13]  627 	LD	(#_AYREGS+11),A
   029E 23            [ 6]  628 	INC	HL
   029F 7E            [ 7]  629 	LD	A,(HL)
   02A0 32r65r00      [13]  630 	LD	(#_AYREGS+11 +1),A
   02A3 23            [ 6]  631 	INC	HL
   02A4 7E            [ 7]  632 	LD	A,(HL)
   02A5 FE 01         [ 7]  633 	CP	#1
   02A7 28 03         [12]  634 	JR	Z,NO_ENVOLVENTES_SONIDO ;NO ESCRIBE LA ENVOLVENTE SI SU VALOR ES 1
   02A9 32r66r00      [13]  635 	LD	(#_AYREGS+13),A
   02AC                     636 	NO_ENVOLVENTES_SONIDO:
   02AC 78            [ 4]  637 	LD	A,B
   02AD CB BF         [ 8]  638 	RES	7,A
   02AF A7            [ 4]  639 	AND	A
   02B0 28 08         [12]  640 	JR	Z,NO_RUIDO
   02B2 32r5Fr00      [13]  641 	LD	(#_AYREGS+6),A
   02B5 3Ar44r00      [13]  642 	LD	A,(#_SFX_MIX)
   02B8 18 06         [12]  643 	JR	SI_RUIDO
   02BA                     644 	NO_RUIDO:
   02BA AF            [ 4]  645 	XOR	A
   02BB 32r5Fr00      [13]  646 	LD	(#_AYREGS+6),A
   02BE 3E B8         [ 7]  647 	LD	A,#0b10111000
   02C0                     648 	SI_RUIDO:
   02C0 32r60r00      [13]  649 	LD	(#_AYREGS+7),A
   02C3 23            [ 6]  650 	INC	HL
   02C4 22r47r00      [16]  651 	LD	(#_PUNTERO_SONIDO),HL
   02C7 C9            [10]  652 	RET
   02C8                     653 	FIN_SONIDO:
   02C8 21r00r00      [10]  654 	LD	HL,#_WYZstate
   02CB CB 96         [15]  655 	RES	2,(HL)
   02CD 3Ar6Ar00      [13]  656 	LD	A,(#_ENVOLVENTE_BACK) ;NO RESTAURA LA ENVOLVENTE SI ES 0
   02D0 A7            [ 4]  657 	AND	A
   02D1 28 03         [12]  658 	JR	Z,FIN_NOPLAYER
                            659 ;xor	a
   02D3 32r66r00      [13]  660 	LD	(#_AYREGS+13),A ;08.13 RESTAURA LA ENVOLVENTE TRAS EL SFX
   02D6                     661 	FIN_NOPLAYER:
   02D6 3E B8         [ 7]  662 	LD	A,#0b10111000
   02D8 32r60r00      [13]  663 	LD	(#_AYREGS+7),A
   02DB C9            [10]  664 	RET
   02DC                     665 	PLAY:
   02DC 21r00r00      [10]  666 	LD	HL,#_WYZstate ;PLAY BIT 1 ON?
   02DF CB 4E         [12]  667 	BIT	1,(HL)
   02E1 C8            [11]  668 	RET	Z
                            669 ;TEMPO
   02E2 21r03r00      [10]  670 	LD	HL,#_TTEMPO ;CONTADOR TEMPO
   02E5 34            [11]  671 	INC	(HL)
   02E6 3Ar02r00      [13]  672 	LD	A,(#_TEMPO)
   02E9 BE            [ 7]  673 	CP	(HL)
   02EA 20 33         [12]  674 	JR	NZ,PAUTAS
   02EC 36 00         [10]  675 	LD	(HL),#0
                            676 ;INTERPRETA
   02EE FD 21r49r00   [14]  677 	LD	IY,#_PSG_REG
   02F2 DD 21r04r00   [14]  678 	LD	IX,#_PUNTERO_A
   02F6 01r51r00      [10]  679 	LD	BC,#_PSG_REG+8
   02F9 CDrBBr03      [17]  680 	CALL	LOCALIZA_NOTA
   02FC FD 21r4Br00   [14]  681 	LD	IY,#_PSG_REG+2
   0300 DD 21r06r00   [14]  682 	LD	IX,#_PUNTERO_B
   0304 01r52r00      [10]  683 	LD	BC,#_PSG_REG+9
   0307 CDrBBr03      [17]  684 	CALL	LOCALIZA_NOTA
   030A FD 21r4Dr00   [14]  685 	LD	IY,#_PSG_REG+4
   030E DD 21r08r00   [14]  686 	LD	IX,#_PUNTERO_C
   0312 01r53r00      [10]  687 	LD	BC,#_PSG_REG+10
   0315 CDrBBr03      [17]  688 	CALL	LOCALIZA_NOTA
   0318 DD 21r34r00   [14]  689 	LD	IX,#_PUNTERO_P ;EL CANAL DE EFECTOS ENMASCARA OTRO CANAL
   031C CDrB7r04      [17]  690 	CALL	LOCALIZA_EFECTO
   031F                     691 	PAUTAS:
   031F FD 21r49r00   [14]  692 	LD	IY,#_PSG_REG+0
   0323 DD 21r10r00   [14]  693 	LD	IX,#_PUNTERO_P_A
   0327 21r51r00      [10]  694 	LD	HL,#_PSG_REG+8
   032A CDrFFr04      [17]  695 	CALL	PAUTA ;PAUTA CANAL A
   032D FD 21r4Br00   [14]  696 	LD	IY,#_PSG_REG+2
   0331 DD 21r12r00   [14]  697 	LD	IX,#_PUNTERO_P_B
   0335 21r52r00      [10]  698 	LD	HL,#_PSG_REG+9
   0338 CDrFFr04      [17]  699 	CALL	PAUTA ;PAUTA CANAL B
   033B FD 21r4Dr00   [14]  700 	LD	IY,#_PSG_REG+4
   033F DD 21r14r00   [14]  701 	LD	IX,#_PUNTERO_P_C
   0343 21r53r00      [10]  702 	LD	HL,#_PSG_REG+10
   0346 CDrFFr04      [17]  703 	CALL	PAUTA ;PAUTA CANAL C
   0349 C9            [10]  704 	RET
                            705 ;DECODIFICA	NOTAS DE UN CANAL
                            706 ;IN	(DE)=DIRECCION DESTINO
                            707 ;NOTA=0	FIN CANAL
                            708 ;NOTA=1	SILENCIO
                            709 ;NOTA=2	PUNTILLO
                            710 ;NOTA=3	COMANDO I
   034A                     711 	DECODE_CANAL:
   034A 7E            [ 7]  712 	LD	A,(HL)
   034B A7            [ 4]  713 	AND	A ;FIN DEL CANAL?
   034C 28 55         [12]  714 	JR	Z,FIN_DEC_CANAL
   034E CDrA8r03      [17]  715 	CALL	GETLEN
   0351 FE 01         [ 7]  716 	CP	#0b00000001 ;ES SILENCIO?
   0353 20 04         [12]  717 	JR	NZ,NO_SILENCIO
   0355 CB F7         [ 8]  718 	SET	6,A
   0357 18 3D         [12]  719 	JR	NO_MODIFICA
   0359                     720 	NO_SILENCIO:
   0359 FE 3E         [ 7]  721 	CP	#0b00111110 ;ES PUNTILLO?
   035B 20 06         [12]  722 	JR	NZ,NO_PUNTILLO
   035D B7            [ 4]  723 	OR	A
   035E CB 08         [ 8]  724 	RRC	B
   0360 AF            [ 4]  725 	XOR	A
   0361 18 33         [12]  726 	JR	NO_MODIFICA
   0363                     727 	NO_PUNTILLO:
   0363 FE 3F         [ 7]  728 	CP	#0b00111111 ;ES COMANDO?
   0365 20 2F         [12]  729 	JR	NZ,NO_MODIFICA
   0367 CB 40         [ 8]  730 	BIT	0,B ;COMADO=INSTRUMENTO?
   0369 28 0F         [12]  731 	JR	Z,NO_INSTRUMENTO
   036B 3E C1         [ 7]  732 	LD	A,#0b11000001 ;CODIGO DE INSTRUMENTO
   036D 12            [ 7]  733 	LD	(DE),A
   036E 23            [ 6]  734 	INC	HL
   036F 13            [ 6]  735 	INC	DE
   0370 7E            [ 7]  736 	LD	A,(HL) ;Nº DE INSTRUMENTO
   0371 12            [ 7]  737 	LD	(DE),A
   0372 13            [ 6]  738 	INC	DE
   0373 23            [ 6]  739 	INC	HL
   0374 7E            [ 7]  740 	LD	A,(HL) ;VOLUMEN RELATIVO DEL INSTRUMENTO
   0375 12            [ 7]  741 	LD	(DE),A
   0376 13            [ 6]  742 	INC	DE
   0377 23            [ 6]  743 	INC	HL
   0378 18 D0         [12]  744 	JR	DECODE_CANAL
   037A                     745 	NO_INSTRUMENTO:
   037A CB 50         [ 8]  746 	BIT	2,B
   037C 28 0B         [12]  747 	JR	Z,NO_ENVOLVENTE
   037E 3E C4         [ 7]  748 	LD	A,#0b11000100 ;CODIGO ENVOLVENTE
   0380 12            [ 7]  749 	LD	(DE),A
   0381 13            [ 6]  750 	INC	DE
   0382 23            [ 6]  751 	INC	HL
   0383 7E            [ 7]  752 	LD	A,(HL)
   0384 12            [ 7]  753 	LD	(DE),A
   0385 13            [ 6]  754 	INC	DE
   0386 23            [ 6]  755 	INC	HL
   0387 18 C1         [12]  756 	JR	DECODE_CANAL
   0389                     757 	NO_ENVOLVENTE:
   0389 CB 48         [ 8]  758 	BIT	1,B
   038B 28 09         [12]  759 	JR	Z,NO_MODIFICA
   038D 3E C2         [ 7]  760 	LD	A,#0b11000010 ;CODIGO EFECTO
   038F 12            [ 7]  761 	LD	(DE),A
   0390 23            [ 6]  762 	INC	HL
   0391 13            [ 6]  763 	INC	DE
   0392 7E            [ 7]  764 	LD	A,(HL)
   0393 CDrA8r03      [17]  765 	CALL	GETLEN
   0396                     766 	NO_MODIFICA:
   0396 12            [ 7]  767 	LD	(DE),A
   0397 13            [ 6]  768 	INC	DE
   0398 AF            [ 4]  769 	XOR	A
   0399 10 FB         [13]  770 	DJNZ	NO_MODIFICA
   039B CB FF         [ 8]  771 	SET	7,A
   039D CB C7         [ 8]  772 	SET	0,A
   039F 12            [ 7]  773 	LD	(DE),A
   03A0 13            [ 6]  774 	INC	DE
   03A1 23            [ 6]  775 	INC	HL
   03A2 C9            [10]  776 	RET	;** JR DECODE_CANAL
   03A3                     777 	FIN_DEC_CANAL:
   03A3 CB FF         [ 8]  778 	SET	7,A
   03A5 12            [ 7]  779 	LD	(DE),A
   03A6 13            [ 6]  780 	INC	DE
   03A7 C9            [10]  781 	RET
   03A8                     782 	GETLEN:
   03A8 47            [ 4]  783 	LD	B,A
   03A9 E6 3F         [ 7]  784 	AND	#0b00111111
   03AB F5            [11]  785 	PUSH	AF
   03AC 78            [ 4]  786 	LD	A,B
   03AD E6 C0         [ 7]  787 	AND	#0b11000000
   03AF 07            [ 4]  788 	RLCA
   03B0 07            [ 4]  789 	RLCA
   03B1 3C            [ 4]  790 	INC	A
   03B2 47            [ 4]  791 	LD	B,A
   03B3 3E 80         [ 7]  792 	LD	A,#0b10000000
   03B5                     793 	DCBC0:
   03B5 07            [ 4]  794 	RLCA
   03B6 10 FD         [13]  795 	DJNZ	DCBC0
   03B8 47            [ 4]  796 	LD	B,A
   03B9 F1            [10]  797 	pop	AF
   03BA C9            [10]  798 	ret
                            799 ;LOCALIZA	NOTA CANAL A
                            800 ;IN	[PUNTERO_A]
                            801 ;LOCALIZA	NOTA CANAL A
                            802 ;IN	[PUNTERO_A]
   03BB                     803 	LOCALIZA_NOTA:
   03BB DD 6E 00      [19]  804 	LD	L,_PUNTERO_A - _PUNTERO_A(IX) ;HL=[PUNTERO_A_C_B]
   03BE DD 66 01      [19]  805 	LD	H,_PUNTERO_A - _PUNTERO_A+1(IX) ;
   03C1 7E            [ 7]  806 	LD	A,(HL)
   03C2 E6 C0         [ 7]  807 	AND	#0b11000000 ;COMANDO?
   03C4 FE C0         [ 7]  808 	CP	#0b11000000
   03C6 20 6B         [12]  809 	JR	NZ,LNJP0
                            810 ;BIT[0]=INSTRUMENTO
   03C8                     811 	COMANDOS:
   03C8 7E            [ 7]  812 	LD	A,(HL)
   03C9 CB 47         [ 8]  813 	BIT	0,A ;INSTRUMENTO
   03CB 28 40         [12]  814 	JR	Z,COM_EFECTO
   03CD 23            [ 6]  815 	INC	HL
   03CE 7E            [ 7]  816 	LD	A,(HL) ;Nº DE PAUTA
   03CF 23            [ 6]  817 	INC	HL
   03D0 5E            [ 7]  818 	LD	E,(HL)
   03D1 E5            [11]  819 	PUSH	HL ;TEMPO
   03D2 21r02r00      [10]  820 	LD	HL,#_TEMPO
   03D5 CB 6B         [ 8]  821 	BIT	5,E
   03D7 28 01         [12]  822 	JR	Z,NO_DEC_TEMPO
   03D9 35            [11]  823 	DEC	(HL)
   03DA                     824 	NO_DEC_TEMPO:
   03DA CB 73         [ 8]  825 	BIT	6,E
   03DC 28 01         [12]  826 	JR	Z,NO_INC_TEMPO
   03DE 34            [11]  827 	INC	(HL)
   03DF                     828 	NO_INC_TEMPO:
   03DF CB AB         [ 8]  829 	RES	5,E ;SIEMPRE RESETEA LOS BITS DE TEMPO
   03E1 CB B3         [ 8]  830 	RES	6,E
   03E3 E1            [10]  831 	POP	HL
   03E4 DD 73 25      [19]  832 	LD	_VOL_INST_A - _PUNTERO_A(IX),E ;REGISTRO DEL VOLUMEN RELATIVO
   03E7 23            [ 6]  833 	INC	HL
   03E8 DD 75 00      [19]  834 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;
   03EB DD 74 01      [19]  835 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   03EE 2ArADr00      [16]  836 	LD	HL,(#_TABLA_PAUTAS) ;(v sdcc) HL,#_TABLA_PAUTAS
   03F1 CDrFFr05      [17]  837 	CALL	EXT_WORD
   03F4 DD 75 12      [19]  838 	LD	_PUNTERO_P_A0 - _PUNTERO_A(IX),L
   03F7 DD 74 13      [19]  839 	LD	_PUNTERO_P_A0 - _PUNTERO_A+1(IX),H
   03FA DD 75 0C      [19]  840 	LD	_PUNTERO_P_A - _PUNTERO_A(IX),L
   03FD DD 74 0D      [19]  841 	LD	_PUNTERO_P_A - _PUNTERO_A+1(IX),H
   0400 69            [ 4]  842 	LD	L,C
   0401 60            [ 4]  843 	LD	H,B
   0402 CB A6         [15]  844 	RES	4,(HL) ;APAGA EFECTO ENVOLVENTE
   0404 AF            [ 4]  845 	XOR	A
   0405 32r66r00      [13]  846 	LD	(#_AYREGS+13),A
   0408 32r56r00      [13]  847 	LD	(#_PSG_REG+13),A
                            848 ;LD	[ENVOLVENTE_BACK],A ;08.13 RESETEA EL BACKUP DE LA ENVOLVENTE
   040B 18 AE         [12]  849 	JR	LOCALIZA_NOTA
   040D                     850 	COM_EFECTO:
   040D CB 4F         [ 8]  851 	BIT	1,A ;EFECTO DE SONIDO
   040F 28 0D         [12]  852 	JR	Z,COM_ENVOLVENTE
   0411 23            [ 6]  853 	INC	HL
   0412 7E            [ 7]  854 	LD	A,(HL)
   0413 23            [ 6]  855 	INC	HL
   0414 DD 75 00      [19]  856 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;
   0417 DD 74 01      [19]  857 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   041A CDr00r01      [17]  858 	CALL	INICIA_SONIDO
   041D C9            [10]  859 	RET
   041E                     860 	COM_ENVOLVENTE:
   041E CB 57         [ 8]  861 	BIT	2,A
   0420 C8            [11]  862 	RET	Z ;IGNORA - ERROR
   0421 23            [ 6]  863 	INC	HL
   0422 7E            [ 7]  864 	LD	A,(HL) ;CARGA CODIGO DE ENVOLVENTE
   0423 32r69r00      [13]  865 	LD	(#_ENVOLVENTE),A
   0426 23            [ 6]  866 	INC	HL
   0427 DD 75 00      [19]  867 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;
   042A DD 74 01      [19]  868 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   042D 69            [ 4]  869 	LD	L,C
   042E 60            [ 4]  870 	LD	H,B
   042F 36 10         [10]  871 	LD	(HL),#0b00010000 ;ENCIENDE EFECTO ENVOLVENTE
   0431 18 88         [12]  872 	JR	LOCALIZA_NOTA
   0433                     873 	LNJP0:
   0433 7E            [ 7]  874 	LD	A,(HL)
   0434 23            [ 6]  875 	INC	HL
   0435 CB 7F         [ 8]  876 	BIT	7,A
   0437 28 3D         [12]  877 	JR	Z,NO_FIN_CANAL_A ;
   0439 CB 47         [ 8]  878 	BIT	0,A
   043B 28 20         [12]  879 	JR	Z,FIN_CANAL_A
   043D                     880 	FIN_NOTA_A:
   043D DD 5E 06      [19]  881 	LD	E,_CANAL_A - _PUNTERO_A(IX)
   0440 DD 56 07      [19]  882 	LD	D,_CANAL_A - _PUNTERO_A+1(IX) ;PUNTERO BUFFER AL INICIO
   0443 DD 73 00      [19]  883 	LD	_PUNTERO_A - _PUNTERO_A(IX),E ;
   0446 DD 72 01      [19]  884 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),D ;
   0449 DD 6E 1E      [19]  885 	LD	L,_PUNTERO_DECA - _PUNTERO_A(IX) ;CARGA PUNTERO DECODER
   044C DD 66 1F      [19]  886 	LD	H,_PUNTERO_DECA - _PUNTERO_A+1(IX)
   044F C5            [11]  887 	PUSH	BC
   0450 CDr4Ar03      [17]  888 	CALL	DECODE_CANAL ;DECODIFICA CANAL
   0453 C1            [10]  889 	POP	BC
   0454 DD 75 1E      [19]  890 	LD	_PUNTERO_DECA - _PUNTERO_A(IX),L ;GUARDA PUNTERO DECODER
   0457 DD 74 1F      [19]  891 	LD	_PUNTERO_DECA - _PUNTERO_A+1(IX),H
   045A C3rBBr03      [10]  892 	JP	LOCALIZA_NOTA
   045D                     893 	FIN_CANAL_A:
   045D 21r00r00      [10]  894 	LD	HL,#_WYZstate ;LOOP?
   0460 CB 66         [12]  895 	BIT	4,(HL)
   0462 20 04         [12]  896 	JR	NZ,FCA_CONT
   0464 F1            [10]  897 	POP	AF
   0465 C3rA5r00      [10]  898 	JP	PLAYER_OFF
   0468                     899 	FCA_CONT:
   0468 DD 6E 2A      [19]  900 	LD	L,_PUNTERO_L_DECA - _PUNTERO_A(IX) ;CARGA PUNTERO INICIAL DECODER
   046B DD 66 2B      [19]  901 	LD	H,_PUNTERO_L_DECA - _PUNTERO_A+1(IX)
   046E DD 75 1E      [19]  902 	LD	_PUNTERO_DECA - _PUNTERO_A(IX),L
   0471 DD 74 1F      [19]  903 	LD	_PUNTERO_DECA - _PUNTERO_A+1(IX),H
   0474 18 C7         [12]  904 	JR	FIN_NOTA_A
   0476                     905 	NO_FIN_CANAL_A:
   0476 DD 75 00      [19]  906 	LD	_PUNTERO_A - _PUNTERO_A(IX),L ;[PUNTERO_A_B_C]=HL GUARDA PUNTERO
   0479 DD 74 01      [19]  907 	LD	_PUNTERO_A - _PUNTERO_A+1(IX),H ;
   047C A7            [ 4]  908 	AND	A ;NO REPRODUCE NOTA SI NOTA=0
   047D 28 37         [12]  909 	JR	Z,FIN_RUTINA
   047F CB 77         [ 8]  910 	BIT	6,A ;SILENCIO?
   0481 28 21         [12]  911 	JR	Z,NO_SILENCIO_A
   0483 0A            [ 7]  912 	LD	A,(BC)
   0484 E6 10         [ 7]  913 	AND	#0b00010000
   0486 20 09         [12]  914 	JR	NZ,SILENCIO_ENVOLVENTE
   0488 AF            [ 4]  915 	XOR	A
   0489 02            [ 7]  916 	LD	(BC),A ;RESET VOLUMEN DEL CORRESPODIENTE CHIP
   048A FD 77 00      [19]  917 	LD	0(IY),A
   048D FD 77 01      [19]  918 	LD	1(IY),A
   0490 C9            [10]  919 	RET
   0491                     920 	SILENCIO_ENVOLVENTE:
   0491 3E FF         [ 7]  921 	LD	A,#0xFF
   0493 32r54r00      [13]  922 	LD	(#_PSG_REG+11),A
   0496 32r55r00      [13]  923 	LD	(#_PSG_REG+11 +1),A
   0499 AF            [ 4]  924 	XOR	A
   049A 32r56r00      [13]  925 	LD	(#_PSG_REG+13),A
   049D FD 77 00      [19]  926 	LD	0(IY),A
   04A0 FD 77 01      [19]  927 	LD	1(IY),A
   04A3 C9            [10]  928 	RET
   04A4                     929 	NO_SILENCIO_A:
   04A4 DD 77 24      [19]  930 	LD	_REG_NOTA_A - _PUNTERO_A(IX),A ;REGISTRO DE LA NOTA DEL CANAL
   04A7 CDr9Fr05      [17]  931 	CALL	NOTA ;REPRODUCE NOTA
   04AA DD 6E 12      [19]  932 	LD	L,_PUNTERO_P_A0 - _PUNTERO_A(IX) ;HL=[PUNTERO_P_A0] RESETEA PAUTA
   04AD DD 66 13      [19]  933 	LD	H,_PUNTERO_P_A0 - _PUNTERO_A+1(IX)
   04B0 DD 75 0C      [19]  934 	LD	_PUNTERO_P_A - _PUNTERO_A(IX),L ;[PUNTERO_P_A]=HL
   04B3 DD 74 0D      [19]  935 	LD	_PUNTERO_P_A - _PUNTERO_A+1(IX),H
   04B6                     936 	FIN_RUTINA:
   04B6 C9            [10]  937 	RET
                            938 ;LOCALIZA	EFECTO
                            939 ;IN	HL=[PUNTERO_P]
   04B7                     940 	LOCALIZA_EFECTO:
   04B7 DD 6E 00      [19]  941 	LD	L,0(IX) ;HL=[PUNTERO_P]
   04BA DD 66 01      [19]  942 	LD	H,1(IX)
   04BD 7E            [ 7]  943 	LD	A,(HL)
   04BE FE C2         [ 7]  944 	CP	#0b11000010
   04C0 20 0D         [12]  945 	JR	NZ,LEJP0
   04C2 23            [ 6]  946 	INC	HL
   04C3 7E            [ 7]  947 	LD	A,(HL)
   04C4 23            [ 6]  948 	INC	HL
   04C5 DD 75 00      [19]  949 	LD	0(IX),L
   04C8 DD 74 01      [19]  950 	LD	1(IX),H
   04CB CDr00r01      [17]  951 	CALL	INICIA_SONIDO
   04CE C9            [10]  952 	RET
   04CF                     953 	LEJP0:
   04CF 23            [ 6]  954 	INC	HL
   04D0 CB 7F         [ 8]  955 	BIT	7,A
   04D2 28 24         [12]  956 	JR	Z,NO_FIN_CANAL_P ;
   04D4 CB 47         [ 8]  957 	BIT	0,A
   04D6 28 18         [12]  958 	JR	Z,FIN_CANAL_P
   04D8                     959 	FIN_NOTA_P:
   04D8 ED 5Br36r00   [20]  960 	LD	DE,(#_CANAL_P)
   04DC DD 73 00      [19]  961 	LD	0(IX),E
   04DF DD 72 01      [19]  962 	LD	1(IX),D
   04E2 2Ar3Ar00      [16]  963 	LD	HL,(#_PUNTERO_DECP) ;CARGA PUNTERO DECODER
   04E5 C5            [11]  964 	PUSH	BC
   04E6 CDr4Ar03      [17]  965 	CALL	DECODE_CANAL ;DECODIFICA CANAL
   04E9 C1            [10]  966 	POP	BC
   04EA 22r3Ar00      [16]  967 	LD	(#_PUNTERO_DECP),HL ;GUARDA PUNTERO DECODER
   04ED C3rB7r04      [10]  968 	JP	LOCALIZA_EFECTO
   04F0                     969 	FIN_CANAL_P:
   04F0 2Ar3Cr00      [16]  970 	LD	HL,(#_PUNTERO_L_DECP) ;CARGA PUNTERO INICIAL DECODER
   04F3 22r3Ar00      [16]  971 	LD	(#_PUNTERO_DECP),HL
   04F6 18 E0         [12]  972 	JR	FIN_NOTA_P
   04F8                     973 	NO_FIN_CANAL_P:
   04F8 DD 75 00      [19]  974 	LD	0(IX),L ;[PUNTERO_A_B_C]=HL GUARDA PUNTERO
   04FB DD 74 01      [19]  975 	LD	1(IX),H
   04FE C9            [10]  976 	RET
                            977 ;	PAUTA DE LOS 3 CANALES
                            978 ;	IN:[IX]:PUNTERO DE LA PAUTA
                            979 ;	(HL):REGISTRO DE VOLUMEN
                            980 ;	[IY]:REGISTROS DE FRECUENCIA
                            981 ;	FORMATO PAUTA
                            982 ;	7 6 5 4 3-0 3-0
                            983 ;	BYTE 1 [LOOP|OCT-1|OCT+1|ORNMT|VOL] - BYTE 2 [ | | | |PITCH/NOTA]
   04FF                     984 	PAUTA:
   04FF CB 66         [12]  985 	BIT	4,(HL) ;SI LA ENVOLVENTE ESTA ACTIVADA NO ACTUA PAUTA
   0501 C0            [11]  986 	RET	NZ
   0502 FD 7E 00      [19]  987 	LD	A,0(IY)
   0505 FD 46 01      [19]  988 	LD	B,1(IY)
   0508 B0            [ 4]  989 	OR	B
   0509 C8            [11]  990 	RET	Z
   050A E5            [11]  991 	PUSH	HL
   050B                     992 	PCAJP4:
   050B DD 6E 00      [19]  993 	LD	L,0(IX)
   050E DD 66 01      [19]  994 	LD	H,1(IX)
   0511 7E            [ 7]  995 	LD	A,(HL)
   0512 CB 7F         [ 8]  996 	BIT	7,A ;LOOP / EL RESTO DE BITS NO AFECTAN
   0514 28 09         [12]  997 	JR	Z,PCAJP0
   0516 E6 1F         [ 7]  998 	AND	#0b00011111 ;MÁXIMO LOOP PAUTA [0,32]X2!!!-> PARA ORNAMENTOS
   0518 07            [ 4]  999 	RLCA	;X2
   0519 16 00         [ 7] 1000 	LD	D,#0
   051B 5F            [ 4] 1001 	LD	E,A
   051C ED 52         [15] 1002 	SBC	HL,DE
   051E 7E            [ 7] 1003 	LD	A,(HL)
   051F                    1004 	PCAJP0:
   051F CB 77         [ 8] 1005 	BIT	6,A ;OCTAVA -1
   0521 28 13         [12] 1006 	JR	Z,PCAJP1
   0523 FD 5E 00      [19] 1007 	LD	E,0(IY)
   0526 FD 56 01      [19] 1008 	LD	D,1(IY)
   0529 A7            [ 4] 1009 	AND	A
   052A CB 0A         [ 8] 1010 	RRC	D
   052C CB 1B         [ 8] 1011 	RR	E
   052E FD 73 00      [19] 1012 	LD	0(IY),E
   0531 FD 72 01      [19] 1013 	LD	1(IY),D
   0534 18 15         [12] 1014 	JR	PCAJP2
   0536                    1015 	PCAJP1:
   0536 CB 6F         [ 8] 1016 	BIT	5,A ;OCTAVA +1
   0538 28 11         [12] 1017 	JR	Z,PCAJP2
   053A FD 5E 00      [19] 1018 	LD	E,0(IY)
   053D FD 56 01      [19] 1019 	LD	D,1(IY)
   0540 A7            [ 4] 1020 	AND	A
   0541 CB 03         [ 8] 1021 	RLC	E
   0543 CB 12         [ 8] 1022 	RL	D
   0545 FD 73 00      [19] 1023 	LD	0(IY),E
   0548 FD 72 01      [19] 1024 	LD	1(IY),D
   054B                    1025 	PCAJP2:
   054B 7E            [ 7] 1026 	LD	A,(HL)
   054C CB 67         [ 8] 1027 	BIT	4,A
   054E 20 2D         [12] 1028 	JR	NZ,PCAJP6 ;ORNAMENTOS SELECCIONADOS
                           1029 ;FUNCION	PITCH DE FRECUENCIA
   0550 23            [ 6] 1030 	INC	HL
   0551 E5            [11] 1031 	PUSH	HL
   0552 5F            [ 4] 1032 	LD	E,A
   0553 7E            [ 7] 1033 	LD	A,(HL) ;PITCH DE FRECUENCIA
   0554 6F            [ 4] 1034 	LD	L,A
   0555 A7            [ 4] 1035 	AND	A
   0556 7B            [ 4] 1036 	LD	A,E
   0557 28 30         [12] 1037 	JR	Z,ORNMJP1
   0559 FD 7E 00      [19] 1038 	LD	A,0(IY) ;SI LA FRECUENCIA ES 0 NO HAY PITCH
   055C FD 86 01      [19] 1039 	ADD	A,1(IY)
   055F A7            [ 4] 1040 	AND	A
   0560 7B            [ 4] 1041 	LD	A,E
   0561 28 26         [12] 1042 	JR	Z,ORNMJP1
   0563 CB 7D         [ 8] 1043 	BIT	7,L
   0565 28 04         [12] 1044 	JR	Z,ORNNEG
   0567 26 FF         [ 7] 1045 	LD	H,#0xFF
   0569 18 02         [12] 1046 	JR	PCAJP3
   056B                    1047 	ORNNEG:
   056B 26 00         [ 7] 1048 	LD	H,#0
   056D                    1049 	PCAJP3:
   056D FD 5E 00      [19] 1050 	LD	E,0(IY)
   0570 FD 56 01      [19] 1051 	LD	D,1(IY)
   0573 ED 5A         [15] 1052 	ADC	HL,DE
   0575 FD 75 00      [19] 1053 	LD	0(IY),L
   0578 FD 74 01      [19] 1054 	LD	1(IY),H
   057B 18 0C         [12] 1055 	JR	ORNMJP1
                           1056 ;FUNCION	ORNAMENTOS
   057D                    1057 	PCAJP6:
   057D 23            [ 6] 1058 	INC	HL
   057E E5            [11] 1059 	PUSH	HL
   057F F5            [11] 1060 	PUSH	AF
   0580 DD 7E 18      [19] 1061 	LD	A,_REG_NOTA_A - _PUNTERO_P_A(IX) ;RECUPERA REGISTRO DE NOTA EN EL CANAL
   0583 5E            [ 7] 1062 	LD	E,(HL) ;
   0584 8B            [ 4] 1063 	ADC	E ;+- NOTA
   0585 CDrA7r05      [17] 1064 	CALL	TABLA_NOTAS
   0588 F1            [10] 1065 	POP	AF
   0589                    1066 	ORNMJP1:
   0589 E1            [10] 1067 	POP	HL
   058A 23            [ 6] 1068 	INC	HL
   058B DD 75 00      [19] 1069 	LD	0(IX),L
   058E DD 74 01      [19] 1070 	LD	1(IX),H
   0591                    1071 	PCAJP5:
   0591 E1            [10] 1072 	POP	HL
   0592 DD 46 19      [19] 1073 	LD	B,_VOL_INST_A - _PUNTERO_P_A(IX) ;VOLUMEN RELATIVO
   0595 80            [ 4] 1074 	ADD	B
   0596 F2r9Br05      [10] 1075 	JP	P,PCAJP7
   0599 3E 01         [ 7] 1076 	LD	A,#1 ;NO SE EXTIGUE EL VOLUMEN
   059B                    1077 	PCAJP7:
   059B E6 0F         [ 7] 1078 	AND	#0b00001111 ;VOLUMEN FINAL MODULADO
   059D 77            [ 7] 1079 	LD	(HL),A
   059E C9            [10] 1080 	RET
                           1081 ;NOTA	: REPRODUCE UNA NOTA
                           1082 ;IN	[A]=CODIGO DE LA NOTA
                           1083 ;	[IY]=REGISTROS DE FRECUENCIA
   059F                    1084 	NOTA:
   059F 69            [ 4] 1085 	LD	L,C
   05A0 60            [ 4] 1086 	LD	H,B
   05A1 CB 66         [12] 1087 	BIT	4,(HL)
   05A3 47            [ 4] 1088 	LD	B,A
   05A4 20 0E         [12] 1089 	JR	NZ,EVOLVENTES
   05A6 78            [ 4] 1090 	LD	A,B
   05A7                    1091 	TABLA_NOTAS:
   05A7 2ArB1r00      [16] 1092 	LD	HL,(#_DATOS_NOTAS) ;BUSCA FRECUENCIA
   05AA CDrFFr05      [17] 1093 	CALL	EXT_WORD
   05AD FD 75 00      [19] 1094 	LD	0(IY),L
   05B0 FD 74 01      [19] 1095 	LD	1(IY),H
   05B3 C9            [10] 1096 	RET
                           1097 ;IN	[A]=CODIGO DE LA ENVOLVENTE
                           1098 ;	[IY]=REGISTRO DE FRECUENCIA
   05B4                    1099 	EVOLVENTES:
   05B4 2ArB1r00      [16] 1100 	LD	HL,(#_DATOS_NOTAS)
                           1101 ;SUB	12
   05B7 07            [ 4] 1102 	RLCA	;X2
   05B8 16 00         [ 7] 1103 	LD	D,#0
   05BA 5F            [ 4] 1104 	LD	E,A
   05BB 19            [11] 1105 	ADD	HL,DE
   05BC 5E            [ 7] 1106 	LD	E,(HL)
   05BD 23            [ 6] 1107 	INC	HL
   05BE 56            [ 7] 1108 	LD	D,(HL)
   05BF D5            [11] 1109 	PUSH	DE
   05C0 3Ar69r00      [13] 1110 	LD	A,(#_ENVOLVENTE) ;FRECUENCIA DEL CANAL ON/OFF
   05C3 1F            [ 4] 1111 	RRA
   05C4 30 08         [12] 1112 	JR	NC,FRECUENCIA_OFF
   05C6 FD 73 00      [19] 1113 	LD	0(IY),E
   05C9 FD 72 01      [19] 1114 	LD	1(IY),D
   05CC 18 09         [12] 1115 	JR	CONT_ENV
   05CE                    1116 	FRECUENCIA_OFF:
   05CE 11 00 00      [10] 1117 	LD	DE,#0
   05D1 FD 73 00      [19] 1118 	LD	0(IY),E
   05D4 FD 72 01      [19] 1119 	LD	1(IY),D
                           1120 ;CALCULO	DEL RATIO (OCTAVA ARRIBA)
   05D7                    1121 	CONT_ENV:
   05D7 D1            [10] 1122 	POP	DE
   05D8 F5            [11] 1123 	PUSH	AF
   05D9 C5            [11] 1124 	PUSH	BC
   05DA E6 03         [ 7] 1125 	AND	#0b00000011
   05DC 47            [ 4] 1126 	LD	B,A
                           1127 ;INC	B
                           1128 ;AND	A ;1/2
   05DD CB 1A         [ 8] 1129 	RR	D
   05DF CB 1B         [ 8] 1130 	RR	E
   05E1                    1131 	CRTBC0:
                           1132 ;AND	A ;1/4 - 1/8 - 1/16
   05E1 CB 1A         [ 8] 1133 	RR	D
   05E3 CB 1B         [ 8] 1134 	RR	E
   05E5 10 FA         [13] 1135 	DJNZ	CRTBC0
   05E7 7B            [ 4] 1136 	LD	A,E
   05E8 32r54r00      [13] 1137 	LD	(#_PSG_REG+11),A
   05EB 7A            [ 4] 1138 	LD	A,D
   05EC E6 03         [ 7] 1139 	AND	#0b00000011
   05EE 32r55r00      [13] 1140 	LD	(#_PSG_REG+11 +1),A
   05F1 C1            [10] 1141 	POP	BC
   05F2 F1            [10] 1142 	POP	AF ;SELECCION FORMA DE ENVOLVENTE
   05F3 1F            [ 4] 1143 	RRA
   05F4 E6 06         [ 7] 1144 	AND	#0b00000110 ;$08,$0A,$0C,$0E
   05F6 C6 08         [ 7] 1145 	ADD	#8
   05F8 32r56r00      [13] 1146 	LD	(#_PSG_REG+13),A
   05FB 32r6Ar00      [13] 1147 	LD	(#_ENVOLVENTE_BACK),A
   05FE C9            [10] 1148 	RET
                           1149 ;EXTRAE	UN WORD DE UNA TABLA
                           1150 ;IN:(HL)=DIRECCION	TABLA
                           1151 ;	[A]= POSICION
                           1152 ;OUT(HL)=WORD
   05FF                    1153 	EXT_WORD:
   05FF 16 00         [ 7] 1154 	LD	D,#0
   0601 07            [ 4] 1155 	RLCA
   0602 5F            [ 4] 1156 	LD	E,A
   0603 19            [11] 1157 	ADD	HL,DE
   0604 5E            [ 7] 1158 	LD	E,(HL)
   0605 23            [ 6] 1159 	INC	HL
   0606 56            [ 7] 1160 	LD	D,(HL)
   0607 EB            [ 4] 1161 	EX	DE,HL
   0608 C9            [10] 1162 	RET
                           1163 ;src\WYZplayer.c:1438: }
                           1164 	.area _CODE
                           1165 	.area _INITIALIZER
                           1166 	.area _CABS (ABS)
